if (self.CavalryLogger) { CavalryLogger.start_js(["qiKXb"]); }

__d("getInstalledRelatedApps",["regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function a(){__p&&__p();return g.async(function(a){__p&&__p();while(1)switch(a.prev=a.next){case 0:if(!(typeof navigator.getInstalledRelatedApps!=="function")){a.next=2;break}return a.abrupt("return",null);case 2:a.next=4;return g.awrap(navigator.getInstalledRelatedApps());case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}},null,this)}e.exports=a}),null);
__d("MLoadingBar",["onAfterTTI"],(function(a,b,c,d,e,f,g){function a(a){g(function(){return a.remove()})}e.exports={init:a}}),null);
__d("XOcelotComposerAsyncLoaderController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/composer/ocelot/async_loader/",{publisher:{type:"Enum",required:!0,enumType:1},target_id:{type:"FBID"}})}),null);
__d("MOcelotComposerPlaceholderFormLoader",["DOM","EventListener","MComposerEntry","MComposerTypes","Stratcom","XOcelotComposerAsyncLoaderController","ge"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m){__p&&__p();e.exports={_isOpen:!1,_isSubmitting:!1,_viewport:HTMLElement,_textarea:HTMLInputElement,_submittingContainer:HTMLElement,initElements:function(a){__p&&__p();var b=l.getURIBuilder().setEnum("publisher",a.publisher).setFBID("target_id",a.targetId).getURI(),c=m("composer-async-loader-root");if(!c){a.elementsParams.forEach(function(a){h.listen(a.element,"click",function(){i.invokeOcelot(b,!0,a.onOpenAction)})});return}this._viewport=m("viewport");this._submittingContainer=g.find(c,"div","composer-submitting");this._textarea=g.find(c,"textarea","composer-placeholder-textarea");var d=g.find(c,"div","cancel_composer");this._placeholderComposerForm=g.find(c,"form","composer-placeholder-form");var e=[h.listen(d,"click",function(a){this.hideComposer()}.bind(this)),h.listen(this._placeholderComposerForm,"submit",function(event){if(this._textarea.value.length===0){event.preventDefault();return!1}this._isSubmitting=!0;g.show(this._submittingContainer);return!0}.bind(this)),k.listen("click","show_composer",function(){this.showComposer(a.autoFocus),i.invokeOcelot(b,!1,j.STATUS,function(){e.forEach(function(a){return a.remove()});return this._isOpen}.bind(this))}.bind(this))];this._placeholderComposerForm.style.display!=="none"&&(this._isOpen=!0,this._isSubmitting=!1,i.invokeOcelot(b,!1,j.STATUS,function(){e.forEach(function(a){return a.remove()});return this._isOpen}.bind(this)));a.elementsParams.forEach(function(c){c.element.onclick=null,h.listen(c.element,"click",function(){if(i.blockNavigateToComposer())return;this.showComposer(a.autoFocus);this._isSubmitting=!1;i.invokeOcelot(b,!1,c.onOpenAction,function(){e.forEach(function(a){return a.remove()});return this._isOpen}.bind(this))}.bind(this))}.bind(this))},showComposer:function(a){this._isOpen=!0,g.show(this._placeholderComposerForm),g.hide(this._viewport),g.hide(this._submittingContainer),a&&this._textarea.focus()},hideComposer:function(){if(this._isSubmitting)return;this._isOpen=!1;g.show(this._viewport);g.hide(this._placeholderComposerForm)}}}),null);
__d("MStoriesProductionInfo",[],(function(a,b,c,d,e,f){"use strict";a={_uploadStatus:null,setUploadStatus:function(a){this._uploadStatus=a},getUploadStatus:function(){return this._uploadStatus}};e.exports=a}),null);
__d("MStoriesUploadStatus",[],(function(a,b,c,d,e,f){"use strict";e.exports=Object.freeze({IDLE:0,UPLOADING:1,FAILED:2})}),null);
__d("XMStoriesProductionPreviewController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/stories/preview/",{})}),null);
__d("MStoriesCreation",["Promise","Bootloader","MPageController","MStoriesProductionInfo","MStoriesUploadStatus","UserAgent","XMStoriesProductionPreviewController","fbt","nullthrows"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){__p&&__p();function p(a){return new g(function(b){var c=new FileReader();c.onload=function(event){return b(event.target.result)};c.readAsDataURL(a)})}q.getChosenImage=function(){"use strict";return q.$6?q.$6.$5():null};function q(a){"use strict";__p&&__p();this.$4=null;this.$7=function(a){a=j.getUploadStatus();if(a===k.UPLOADING){h.loadModules(["MStoriesToast"],function(a){a.showDefaultToast(n._("Uploading story"))},"MStoriesCreation");return}j.setUploadStatus(k.IDLE);this.$3.click()}.bind(this);var b=null,c=0,d=l.isBrowser("Firefox")&&l.isPlatform("Android");this.$2=a.item;this.$3=a.input;q.$6=this;this.$5=function(){return{URI:b,rotate:c}};this.$2.addEventListener("click",this.$7,!0);this.$3&&this.$3.addEventListener("change",function(a){__p&&__p();a=a.target.files;var e=null;for(var f=0;f<a.length;f++)if(a[f].type.match(/^image\//)){e=a[f];break}e!==null&&h.loadModules(["ImageExifRotation","promiseDone"],function(a,f){a.getRotation(e,function(a){c=a,d?f(p(o(e)),function(a){b=a,this.$8()}.bind(this)):(b=URL.createObjectURL(o(e)),this.$8())}.bind(this))}.bind(this),"MStoriesCreation")}.bind(this))}q.prototype.$8=function(){"use strict";var a=m.getURIBuilder().getURI();i.load(a)};q.$6=null;e.exports=q}),null);
__d("MFBStoriesTraySigil",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({POG_CONTAINER:"m-stories-tray-pog-container",POG_PICTURE:"m-stories-tray-pog-picture",ARCHIVE_LINK:"m-stories-tray-archive-link"})}),null);
__d("MStoriesGating",["gkx"],(function(a,b,c,d,e,f,g){"use strict";a={shouldShowProduction:function(){return g("AT5zxbb0FdJe9KTsqd3-xxTabP4TMu6--Fdclj0I6LmXtOFDG92QFA0vVFCF3AlJrt8xNWV-iIxzJfLxjGqzNLu0")},genShouldShowTextOverlays:function(){return g("AT54El2y9rGeymns51TxOKbhbZkT6WrJWswADGeiX5tFO2-X5KhW8wcDOQmUOb_K4cU5FYspKc4d0t8qZVqCOh8UxqWTQazARLrpiHPXzC48IQ")},genShouldShowStoriesEffects:function(){return g("AT7ZQQt0LbPbGiJeDwkR1M1Y-2xh_j5DYk866JaHyusEpw62uCyIQioQAPNOqVOQylR6WRYgcjMoXPBPDRGVAgH6")}};e.exports=a}),null);
__d("MArrays",[],(function(a,b,c,d,e,f){"use strict";e.exports={findPrefix:function(a,b){for(var c=0;c<a.length;c++)if(b.startsWith(a[c]))return!0;return!1}}}),null);
__d("MStoriesUIConstants",[],(function(a,b,c,d,e,f){"use strict";a={PROGRESS_BAR:{DEFAULT_TIMER_DURATION_IN_SEC:6,STORY_UPDATE_TICK_IN_SEC:.1},REDIRECT_DELAY_IN_MS:20,REFRESH_TIMEOUT_IN_MS:10*60*1e3,SEC_TO_MS:1e3,SWIPE_DISTANCE:80,SWIPE_DOWN_DISTANCE:150,CACHE_EXPIRATION_IN_MS:10*60*1e3,UPLOAD_SUCCESSFUL:"Story Added",UPLOAD_FAILED:"Unable to Add Story",HIDE_HEADER_URLS:["/stories/view_tray","/stories/preview/"]};e.exports=a}),null);
__d("MStoriesHideHeaderListener",["Bootloader","MArrays","MStoriesUIConstants","Stratcom","URI"],(function(a,b,c,d,e,f,g,h,i,j,k){"use strict";__p&&__p();var l="m:page:render:start";a={_hideHeaderListener:null,setup:function(){if(this._hideHeaderListener)return;this._hideHeaderListener=j.listen(l,null,function(a){a=new k(a.getData().path);a=a.getPath();h.findPrefix(i.HIDE_HEADER_URLS,a)&&(g.loadModules(["MStoriesDisplayUtils"],function(a){a.toggleChromeBar(!1)},"MStoriesHideHeaderListener"),j.removeCurrentListener(),this._hideHeaderListener=null)}.bind(this))}};e.exports=a}),null);
__d("MStoriesID",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({LOADING_SCREEN:"m-stories-viewer-thread-loading-spinner",PRIVACY_BLACKLIST_DIV:"m-stories-privacy-selector-blacklist",PRODUCTION_ADD_ITEM_DIV:"m-stories-add-item",PRODUCTION_ADD_ITEM_POG:"m-stories-add-item-pog",PRODUCTION_OWNER_ITEM_DIV:"m-stories-owner-bucket",PRODUCTION_OWNER_ITEM_POG:"m-stories-owner-bucket-pog",PRODUCTION_INPUT:"m-stories-production-input",PRODUCTION_ROOT:"m-stories-production-root",TRAY_DIV:"story_tray",PRODUCTION_COLOR_PICKER_PREFIX:"color-picker-",ARCHIVE_INTRO_DIALOG_BOX:"m-stories-archive-intro-dialog-box",PRODUCTION_EFFECTS_PREFIX:"effect-"})}),null);
__d("MStoriesProductionUtils",["MFBStoriesGatingConfig","MStoriesID","cx"],(function(a,b,c,d,e,f,g,h,i){"use strict";a={getAnimationPog:function(){var a=document.getElementById(h.PRODUCTION_OWNER_ITEM_POG);return a?a:document.getElementById(h.PRODUCTION_ADD_ITEM_POG)},getUploadingClass:function(){return g.rectangularPreviewsEnabled&&!g.largeRectangularPreviewsEnabled?"_6mf-":"_1zpf"},getErrorClass:function(){return g.rectangularPreviewsEnabled&&!g.largeRectangularPreviewsEnabled?"_6mf_":"_4ts1"}};e.exports=a}),null);
__d("MStoriesTrayInfo",[],(function(a,b,c,d,e,f){"use strict";a={_trayBucketIDs:[],_trayNeedsRefresh:!1,setTrayBucketIDs:function(a){this._trayBucketIDs=a.bucketIDs},getTrayBucketIDs:function(){return this._trayBucketIDs},setTrayNeedsRefresh:function(a){this._trayNeedsRefresh=a},getTrayNeedsRefresh:function(){return this._trayNeedsRefresh}};e.exports=a}),null);
__d("MStoriesTrayUIConstants",[],(function(a,b,c,d,e,f){"use strict";a={REDIRECT_DELAY_IN_MS:20};e.exports=a}),null);
__d("MStoriesTrayAsync",["Bootloader","CSS","DOM","MFBStoriesGatingConfig","MFBStoriesTraySigil","MPageController","MStoriesGating","MStoriesHideHeaderListener","MStoriesID","MStoriesProductionInfo","MStoriesProductionUtils","MStoriesTrayInfo","MStoriesTrayUIConstants","MStoriesUploadStatus","Run","Stratcom","cx"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){__p&&__p();var x="m:page:render:cache:complete-with-replays";a={_currentItemLoading:null,_listeners:[],_spinner:null,_shouldShowProduction:m.shouldShowProduction(),_uploadStatus:null,updateSpinner:function(a){__p&&__p();this._spinner=a.spinner,this._listeners.length===0&&(this._listeners=[v.listen(x,null,function(){if(!r.getTrayNeedsRefresh())return;g.loadModules(["MStoriesTrayUtils"],function(a){a.refreshTray()},"MStoriesTrayAsync")}),v.listen("click",k.ARCHIVE_LINK,this._openArchive),v.listen("click",k.POG_CONTAINER,function(a){__p&&__p();this._currentItemLoading&&h.removeClass(this._currentItemLoading,"loading");var b=a.getNode(k.POG_CONTAINER);if(!b)return;this._shouldShowProduction&&b.id===o.PRODUCTION_OWNER_ITEM_DIV?g.loadModules(["MStoriesProductionTrayAsync"],function(a){if(!b)return;if(a.handleFailedAddToStoryPogSelected())return;this._openViewer(b)}.bind(this),"MStoriesTrayAsync"):this._openViewer(b)}.bind(this))]),n.setup(),this._updateProductionPog(),u.onLeave(function(){this._destroy()}.bind(this))},_updateProductionPog:function(){if(p.getUploadStatus()!==t.UPLOADING)return;var a=q.getAnimationPog(),b=document.getElementById(o.PRODUCTION_ADD_ITEM_POG),c=document.getElementById(o.PRODUCTION_ADD_ITEM_DIV),d=document.getElementById(o.PRODUCTION_OWNER_ITEM_POG),e=q.getUploadingClass();a&&(h.addClass(a,e),a.id===o.PRODUCTION_OWNER_ITEM_POG?(b&&h.removeClass(b,e),c&&h.addClass(c,"disable")):(d&&h.removeClass(d,e),c&&h.removeClass(c,"disable")))},_openArchive:function(event){var a=event.getNode(k.ARCHIVE_LINK);if(a!=null){var b=a.getAttribute("data-href");b&&setTimeout(function(){l.load(b,{hideLoadingIndicator:!1})})}},_openViewer:function(a){this._currentItemLoading=a;var b;j.rectangularPreviewsEnabled?b=i.find(a,"img",k.POG_PICTURE):b=i.find(a,"i",k.POG_PICTURE);b&&(i.insertAfter(b,this._spinner),h.addClass(a,"loading"));var c=a.getAttribute("data-href");c&&setTimeout(function(){l.load(c,{hideLoadingIndicator:!0})},s.REDIRECT_DELAY_IN_MS)},_destroy:function(){var a=q.getAnimationPog();a&&h.removeClass(a,q.getUploadingClass());this._listeners.forEach(function(a){return a.remove()});this._listeners=[]}};e.exports=a}),null);
__d("XFeedEgoLoadController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ego/feed/load/",{loading_id:{type:"String",required:!0},ids:{type:"IntVector",required:!0},service_id:{type:"String",required:!0},replace_data:{type:"String",defaultValue:""},location:{type:"String",defaultValue:""},group_size:{type:"Int",defaultValue:1},qid:{type:"Int",required:!0},mf_story_key:{type:"Int",required:!0}})}),null);
__d("MSwipeInfiniteScrollerLoadMore",["DataAttributeUtils","DOM","MLegacyDataStore","MRequest","MRequestTypes","MURI","Parent","XFeedEgoLoadController","csx"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){__p&&__p();var p=-45,q=200;function a(a){__p&&__p();var b=h.scry(a,"*","m-infinite-swipe-loading")[0];if(!b)return;var c=i.get(b);if(c.processing)return;i.set(b,{processing:!0});if(c.use_uri){new j(new l(c.uri).toString()).setType(k.DEPENDENT).send();return}c=[];a=a.children;var d,e;for(var f=0;f<a.length;f++){f===0&&(e=a[f].getAttribute("data-service"));var o=g.getDataFt(a[f]);if(!o)continue;f===0&&(d=JSON.parse(o));o=JSON.parse(o).ego_id;c.push(o)}o=n.getURIBuilder().setString("loading_id",b.id).setIntVector("ids",c).setString("service_id",e||"pymk").setString("location","inline_feed").setInt("qid",d.qid).setInt("mf_story_key",d.mf_story_key).getURI();f=new j(new l(o).toString()).setType(k.DEPENDENT);a=function(){var a=m.bySelector(b,".scrollArea");r(a.id);i.set(b,{processing:!1})};f.listen("done",a.bind(this));f.send()}function r(a){__p&&__p();a=document.getElementById(a);if(!a)return;var b=i.get(a);if(!b||!b.scrollArea)return;var c=h.scry(a,"*","m-swipe-pymk-item")[0];c=g.getDataAttribute(c,"data-unit-size");c||(c=q);var d=b.scrollArea;if(d.getAutomaticPaging())d.reflow("auto");else{d=h.find(a,"*","scroll-area-body").children;a=[p];for(var e=1;e<d.length;e++)a[e]=a[e-1]+parseInt(c,10);b.scrollArea.reflow(a)}}e.exports={maybeLoadMore:a,reflow:r}}),null);
__d("XEgoHideLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ego/feed/logging/xout/",{ego_id:{type:"Int",required:!0},qid:{type:"Int",required:!0},mf_story_key:{type:"Int",required:!0},service_id:{type:"String",required:!0}})}),null);
__d("XEgoPYMIActionsLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/pymi/logging/",{action:{type:"String",required:!0},invitee_name:{type:"String"},qid:{type:"Int"},mf_story_key:{type:"String"},ego_id:{type:"Int"},how_found:{type:"String"}})}),null);
__d("MSwipeInfiniteScroller",["AsyncSignal","CSS","DataAttributeUtils","DOM","MFriendingState","MLegacyDataStore","MParent","MRequest","MScrollAreaHelper","MSwipeInfiniteScrollerLoadMore","Stratcom","XEgoHideLoggingController","XEgoPYMIActionsLoggingController","XFeedEgoImpressionLoggingController","cx"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){__p&&__p();var v=3,w={},x={};function a(a){__p&&__p();var b=a.getData().event;if(!b.getNode("m-swipe-pymk-item")&&!b.getNode("m-swipe-pysf-item"))return;var c=b.getTarget(),d=l.get(c);d._delayTimer&&clearTimeout(d._delayTimer);d._delayTimer=setTimeout(function(){d.scrollArea===undefined&&(d.scrollArea=o.findScrollArea(c,12)),d.scrollArea&&(d.scrollArea.scrollByPages(1),q.invoke("MSwipeInfiniteScroller:autoScrollStart",null,b))},1e3);d._touchstartListener&&d._touchstartListener.remove();d._touchstartListener=q.listen("touchstart",null,function(a){clearTimeout(d._delayTimer),delete d._delayTimer,d._touchstartListener.remove(),delete d._touchstartListener});if(b.getNode("m-swipe-pymk-item")){a=m.bySigil(c,"undoable-action");if(!a)return;a=j.scry(a,"*","pymk-remove-button")[0];a&&h.hide(a)}}function b(a){a=a.getData().event;if(!a.getNode("m-swipe-pymk-item"))return;a=a.getTarget();a=m.bySigil(a,"undoable-action");if(!a)return;a=j.scry(a,"*","pymk-remove-button")[0];a&&h.show(a)}function c(event){var a=event.getData(),b=a.scrollarea;z(b,a.container)}var y=function(a){__p&&__p();a=JSON.parse(i.getDataFt(a));if(!a)return;var b=a.ego_id,c=a.qid;a=a.mf_story_key;var d=(c+a).toString();if(!b||w[d]&&w[d][b])return;c=t.getURIBuilder().setInt("ego_id",b).setInt("qid",c).setInt("mf_story_key",a).getURI();new g(c,{}).send();w[d]||(w[d]={});w[d][b]=!0};function z(a,b){__p&&__p();var c=a.getScrollPageIndex()+1,d=a.getScrollPageCount(),e=a.getScrollPageIndex();c+v>=d&&p.maybeLoadMore(b);c=a.getChildAtPageIndex(0);if(!c){j.remove(a._content.parentNode.parentNode.parentNode);return}d=JSON.parse(i.getDataFt(c));if(!d)return;b=d.qid;c=d.mf_story_key;d=0;b=(b+c).toString();x[b]&&(d=x[b]);for(var c=d;c<=e;c++)y(a.getChildAtPageIndex(c));x[b]=Math.max(d,e+1)}function d(event){var a=event.getNode("m-swipe-pymi-item");if(!a)return;var b=o.findScrollArea(a);if(!b)return;setTimeout(function(){b.scrollByPages(1)},500)}function e(event){__p&&__p();var a=event.getNode("m-swipe-pymk-item"),b="PYMK";a||(a=event.getNode("m-swipe-pysf-item"),b="PYSF");a||(a=event.getNode("m-swipe-pymi-item"),b="PYMI");if(!a)return;var c=o.findScrollArea(a);if(!c)return;var d=JSON.parse(i.getDataFt(a));if(d&&d.ego_id){var e=r.getURIBuilder().setInt("ego_id",d.ego_id).setInt("qid",d.qid).setInt("mf_story_key",d.mf_story_key).setString("service_id",b).getURI();new n(e).send();if(b=="PYMI"){e=s.getURIBuilder().setString("action","xout").setInt("ego_id",d.ego_id).setString("how_found","mtouch_feed").getURI();new n(e).send()}}h.addClass(a,"_3m57");if(!c._canUseHscroll&&!c._isHorizontal){j.remove(a);return}setTimeout(function(){j.remove(a),p.reflow(c._element.id),z(c,c._content)},500);b=c.getScrollPageIndex()+1;d=c.getChildAtPageIndex(b);y(d)}q.listen("MScrollArea:scrollend","infiniteScroller",c);q.listen("click","invite-contact-button",d);q.listen(k.REQUEST_SENT,null,a);q.listen(k.REQUEST_CANCELED,null,b);q.listen("click","m-swipe-xout",e);f.logImpressionForElement=y}),null);
__d("MSwipePymkFirstUnitImpression",["MSwipeInfiniteScroller","MViewport","Stratcom","Vector"],(function(a,b,c,d,e,f,g,h,i,j){__p&&__p();function a(a){i.listen("MScrollArea:create",null,function(event){if(event.getData().element.getAttribute("id")===a){var b=event.getData().scrollarea;if(b)var c=event.getData().element,d=i.listen("scroll",null,function(){var a=h.getScreenHeight()+h.getScrollTop(),e=j.getElementPosition(c).y+c.clientHeight;e&&a>=e&&(g.logImpressionForElement(b.getChildAtPageIndex(0)),d&&(d.remove(),d=null))})}})}e.exports={setup:a}}),null);
__d("XRelatedApplicationsLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/related-application/",{call_success:{type:"Bool",defaultValue:!1},checked_installed_related_apps:{type:"StringKeyset",defaultValue:[]},present_installed_related_apps:{type:"StringKeyset",defaultValue:[]}})}),null);
__d("MRelatedApplicationsLogging",["MRequest","XRelatedApplicationsLoggingController","getInstalledRelatedApps","promiseDone"],(function(a,b,c,d,e,f,g,h,i,j){__p&&__p();var k=h.getURIBuilder();function a(a){__p&&__p();j(i(),function(b){k.setStringKeyset("checked_installed_related_apps",a);if(b!=null&&b.length>0){k.setBool("call_success",!0);b=b.map(function(a){return a.id});k.setStringKeyset("present_installed_related_apps",b)}else k.setBool("call_success",!1);new g(k.getURI()).setIgnoreErrors(!0).send()})}e.exports={init:a}}),null);