if (self.CavalryLogger) { CavalryLogger.start_js(["jzg8D"]); }

__d("ChatProxyConnectionState",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.auxiliaryIrisQueues={},this.aiq=null}a.prototype.subscribeIrisQueue=function(a,b){this.auxiliaryIrisQueues[a]=b,this.updateCaches()};a.prototype.unsubscribeIrisQueue=function(a){delete this.auxiliaryIrisQueues[a],this.updateCaches()};a.prototype.updateCaches=function(){var a=[];for(var b in this.auxiliaryIrisQueues)Object.prototype.hasOwnProperty.call(this.auxiliaryIrisQueues,b)&&(a.push(b),a.push(this.auxiliaryIrisQueues[b]));a.length===0?this.aiq=null:this.aiq=a.join(",")};e.exports=a}),null);
__d("ChannelDefaults",[],(function(a,b,c,d,e,f){e.exports={LONGPOLL_TIMEOUT:6e4,STALL_THRESHOLD:18e4,MIN_RETRY_INTERVAL:5e3,MAX_RETRY_INTERVAL:3e4}}),null);
__d("ChannelStateMap",[],(function(a,b,c,d,e,f){e.exports={pull:{ok:"pull!",error:"pull",error_missing:"pull",error_msg_type:"pull",clock_anomaly:"pull!",visible:"pull!",hidden:"idle!",refresh_0:"reconnect",refresh_110:"reconnect!",refresh_111:"reconnect",refresh_112:"pull",refresh_113:"pull",refresh_117:"reconnect"},reconnect:{ok:"pull!",error:"reconnect",clock_anomaly:"reconnect!",visible:"pull!",hidden:"idle!"},idle:{ok:"idle!",clock_anomaly:"idle!",visible:"pull!",hidden:"idle!"},shutdown:{clock_anomaly:"shutdown!",visible:"shutdown!",hidden:"shutdown!"}}}),null);
__d("RTISession",["ErrorUtils","PHPQuerySerializer","URI","XHRRequest","getCrossOriginTransport","invariant"],(function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";__p&&__p();var m=".facebook.com";function a(a,b,c,d,e,f,g,h,i){a||l(0),d||l(0),e||l(0),this.domain=a,this.port=b,this.edgePoolName=c,this.stickyToken=d,this.loggedInId=e,this.accountId=f,this.clientProfile=g||"desktop",this.clientId=h,this.capabilities=i}a.prototype.issueRequest=function(a,b,c,d,e){__p&&__p();a||l(0);b||l(0);d||l(0);var f=this.domain.length-m.length;f=f>0&&this.domain.indexOf(m,f)!==-1;f=f?this.domain:this.domain+m;var n=(1048576*Math.random()|0).toString(36);n={cb:n,sticky_token:this.stickyToken,uid:this.loggedInId,viewer_uid:this.accountId,sticky_pool:this.edgePoolName,profile:this.clientProfile,clientid:this.clientId,cap:this.capabilities};for(var o in n)b[o]&&l(0);Object.assign(n,b);b=new i(a).setDomain(f).setPort(this.port).setSecure(new i(window.location.href).isSecure()).setQueryData(n);a=c?"POST":"GET";var p={};new j(b).setTransportBuilder(k.withCredentials).setTimeout(e?e*1e3:3e4).setMethod(a).setDataSerializer(function(a){return h.serialize(JSON.stringify(a))}).setData(c).setRequestHeader("Content-Type","application/x-www-form-urlencoded").setResponseHandler(function(a){a=a.substring("for (;;);".length);p.data=JSON.parse(a);p.error=null;g.applyWithGuard(d,this,[p])}.bind(this)).setErrorHandler(function(a){p.data=null,p.error=a.errorMsg||"error",g.applyWithGuard(d,this,[p])}.bind(this)).send()};e.exports=a}),null);
__d("StateMachine",["EventEmitter","ex","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j,k=0;function l(a,b){"use strict";this.idx=k++,this.machine=a,this.asap=b&&b.substr(-1)=="!",this.name=this.asap?b.substr(0,b.length-1):b,this.progress=n.NEW,this.status=null}l.prototype.enter=function(){"use strict";this.machine.enter_private(this)};l.prototype.exit=function(a){"use strict";this.machine.exit_private(this,a)};l.prototype.toString=function(){"use strict";return this.name+"("+this.progress+","+this.status+")"};var m="_ABORT_";a=babelHelpers.inherits(n,g);j=a&&a.prototype;function n(a,b){"use strict";j.constructor.call(this),this.$StateMachine1=a,this.$StateMachine2=b,this.$StateMachine3=0,this.$StateMachine4=[],this.$StateMachine5=Date.now()}n.prototype.$StateMachine6=function(a){"use strict";this.$StateMachine4.push(Date.now()-this.$StateMachine5+": "+a),this.$StateMachine4.length>40&&(this.$StateMachine4=this.$StateMachine4.splice(-20))};n.prototype.getState=function(){"use strict";return this.$StateMachine7};n.prototype.setDelay=function(a){"use strict";this.$StateMachine3=a||0;return this};n.prototype.getDelay=function(){"use strict";return this.$StateMachine3};n.prototype.enter=function(a){"use strict";this.enter_private(new l(this,a))};n.prototype.enter_private=function(a){"use strict";this.$StateMachine6("enter "+a+", "+this.$StateMachine7),this.$StateMachine7&&this.$StateMachine7!=a&&this.$StateMachine7.exit(m),this.$StateMachine7=a,a.asap?(delete a.asap,this.$StateMachine2.enter&&this.$StateMachine2.enter(a),a.progress=n.ENTERED):(a.progress=n.PENDING,a.asap=!0,a.$StateMachine8=i(function(){a.enter()},this.$StateMachine3)),this.emit(n.ENTER,a)};n.prototype.exit=function(a){"use strict";this.exit_private(this.$StateMachine7,a)};n.prototype.exit_private=function(a,b){"use strict";__p&&__p();this.$StateMachine6("exit "+a+", "+b+", "+this.$StateMachine7);if(!a||a!=this.$StateMachine7)throw new Error(h("Invalid state: %s, history: %s",a,this.$StateMachine4.join("|")));if(a.progress==n.EXITED)return;a.status=b;a.progress=n.EXITED;a.$StateMachine8&&(clearInterval(a.$StateMachine8),a.$StateMachine8=null);this.$StateMachine7=null;a&&this.$StateMachine2.exit&&this.$StateMachine2.exit(a);a.exited=!0;this.emit(n.EXIT,a);if(b!=m){var c=this.$StateMachine1[a.name];if(!c||!c[b])throw new Error(h("No exit for state:%s, status: %s",a.name,b));this.enter(c[b])}};n.ENTER="enter";n.EXIT="exit";n.NEW="new";n.PENDING="pending";n.ENTERED="entered";n.EXITED="exited";e.exports=n}),null);
__d("rand32",[],(function(a,b,c,d,e,f){function a(){return Math.floor(Math.random()*4294967295)}e.exports=a}),null);
__d("MChannelManager",["Banzai","ChannelClientConfig","ChannelClientID","ChannelDefaults","ChannelEventEmitter","ChannelEventType","ChannelStateMap","ChatProxyConnectionState","Clock","FBLogger","LogHistory","MRequest","MURI","RTISession","StateMachine","URI","Visibility","gkx","rand32","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){__p&&__p();var A,B="ok",C="error",D=6e4,E=null,F=null,G=null,H=null,I=null,J=-1,K=null,L=0,M=i.getID(),N=!1;i={enter:function(a){__p&&__p();H&&(H.abort(),H=null);switch(a.name){case"pull":if(!F.uri)break;if(F.disabled)break;var b=new v(F.uri),c={channel:F.user_channel,seq:G,clientid:M,profile:"mobile",partition:F.partition,sticky_token:J,msgs_recv:L,qp:"y",cb:y()};J==-1&&F.msgr_region&&(c.msgr_region=F.msgr_region);F.chat_enabled&&(c.state="active");K&&(c.sticky_pool=K);F.uid&&F.viewerUid&&(c.uid=F.uid,c.viewer_uid=F.viewerUid);F.state.aiq&&(c.aiq=F.state.aiq);H=new r(b+"").setCORS(!0).setMethod("GET").setData(c).setRaw(!0);H.listen("open",function(a){a.getTransport().withCredentials=!0});H.listen("done",function(b){R(a,b)});H.listen("error",function(){R(a)});break;case"reconnect":b=new s("/a/channel/reconnect.php");H=new r(b+"").setMethod("GET");H.listen("done",function(b){P(a,b)});H.listen("error",function(b){b.isHandled=!0,P(a)});break;default:}H&&H.send()},exit:function(a){if(a.status==="ok")a.name==="pull"&&A.setDelay(0);else if(!(a.status==null)){a=A.getDelay();a=a>0?a*2:E.MIN_RETRY_INTERVAL;a=Math.min(a,E.MAX_RETRY_INTERVAL);A.setDelay(a)}H&&(H.abort(),H=null)}};function O(){var a=null;N&&F&&F.host&&J&&F.uid&&(a=new t(F.host,null,K,J,F.uid,F.viewerUid,"mobile",M,0));k.emit(l.RTI_SESSION,a)}function b(a){I=a}function P(a,b){!b?(p("FIXME").warn("_onReconnectError: reconnect request error"),a.exit(C)):b.user_channel?(F=b,F.state=new n(),G=F.seq,a.exit(B)):(p("FIXME").warn("_onReconnectError: bad reconnect response - %s",JSON.stringify(b)),a.exit(C))}function Q(){N=!0,O()}function R(a,b){__p&&__p();var c=B;if(!b){a.exit(C);return}switch(b.t){case"refresh":case"refreshDelay":c="refresh_"+(b.reason||0);break;case"fullReload":c=B;b.seq==0&&Q();"ms"in b&&S(b);break;case"continue":break;case"lb":var d=b.lb_info;if(d){J=d.sticky;var e="http://";F.is_secure_uri&&(e="https://");"pool"in d?K=d.pool:(F.uri=e+d.vip+".facebook.com/pull",F.host=d.vip)}else p("FIXME").mustfix("bad lb info from channel proxy");break;case"msg":S(b);break;case"batched":e=b.batches;for(d=0;d<e.length;d++)R(a,e[d]);break;case"heartbeat":break;default:c=C;g.isEnabled("mchannel_detailed_log")?p("FIXME").warn("_onRequestSuccess: invalid channel response, resending request: %s",JSON.stringify(b)):p("FIXME").warn("_onRequestSuccess: invalid channel response, sending request again.");break}"seq"in b&&(G=b.seq);a.exit(c)}function S(a){__p&&__p();var b=a.seq-a.ms.length;for(var c=0;c<a.ms.length;c++){var d=b+c;L++;if(d>=G){I&&(a.ms[c]=I(a.ms[c]));try{if(a.ms[c].type==="skywalker")k.emit(l.SKYWALKER_MESSAGE,a.ms[c]);else if(a.ms[c].type==="qprimer")Q();else if(a.ms[c].type==="privacy_changed"){if(x("AT676eqa9o_v7kGGM53Nfaq6v7ZzAZW1E6NXkuIXW-8sM0N4DkZ16pxYoDT5UIQfy6xorIGXMlqtYgTSAc6F7oiK")){d=a.ms[c].data;d.visiblity!==undefined&&d.visibility!==null&&(F.chat_enabled=d.visibility)}}else A.emit(A.CHANNEL_MESSAGE,a.ms[c])}catch(b){g.isEnabled("mchannel_detailed_log")?p("FIXME").warn("_processMessages: threw exception emitting: ex:%s payload:%s",b,JSON.stringify(a.ms[c])):p("FIXME").warn("_processMessages: failed to emit message")}}}}function c(){__p&&__p();if(!A.xhrEnabled||E)return;E=Object.assign(j,h.config);F=h.info;F.state=new n();G=F.seq;o.addListener(o.ANOMALY,function(){A.exit("clock_anomaly")});w.addListener(w.HIDDEN,function(){A.exit("hidden")});w.addListener(w.VISIBLE,function(){A.exit("visible")});a.onbeforeunload=function(){H&&H.abort()};"sticky_token"in F&&(J=F.sticky_token);T()}function d(a,b){F.state.subscribeIrisQueue(a,b)}function f(a){F.state.subscribeIrisQueue(a)}function T(){A.setDelay(E.MIN_RETRY_INTERVAL),A.enter(F.uri?"pull!":"reconnect!")}A=new u(m,i);A.startChannel=c;A.setTransform=b;A.xhrEnabled=!!a.XMLHttpRequest;A.CHANNEL_MESSAGE="channel_message";A.subscribeIrisQueue=d;A.unsubscribeIrisQueue=f;var U;function V(){A.emit(u.ENTER,{name:"stall",progress:u.ENTERED}),g.isEnabled("mchannel_jumpstart")&&T()}function W(a){q.getInstance("channel").log(a.name,a.status||a.progress),a.name!=="stall"&&(clearTimeout(U),U=z(V,D))}A.addListener(u.ENTER,W);A.addListener(u.EXIT,W);k.addListener(l.GET_RTI_SESSION_REQUEST,O);e.exports=A}),null);
__d("MTouchChannelManager",["Bootloader","MChannelManager","gkx","onAfterDisplay"],(function(a,b,c,d,e,f,g,h,i,j){__p&&__p();var k=!1;function a(){if(k)return;k=!0;h.addListener(h.CHANNEL_MESSAGE,function(a){return g.loadModules(["MTouchChannelPayloadRouter"],function(b){return b.route(a)},"MTouchChannelManager")});i("AT7hEXKDPRRW6Wob3gOR08YjZOkaLBwZd1PuueXvcTN4Rf11lfNfB9WK3WbaqPe8byRLvTy1D2DV4KnVfPcRBxj0yHW62I5Gno0Xjf1qRbux-g")?j(h.startChannel):h.startChannel()}f.initialize=a}),null);
__d("MPresenceIcon",["DOM","MLegacyDataStore","MRequest","MURI","Stratcom","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g,h,i,j,k,l){__p&&__p();var m=0,n=1,o=2,p;function q(){__p&&__p();var a=g.scry(document.body,"i","presence-icon"),b=[];for(var c=0,d=a.length;c<d;++c){var e=h.get(a[c]);e.userid&&!b[e.userid]&&(b[e.userid]=1)}e=new j("/chat/presence_icon.php").toString();c=new i(e).setData({ids:Object.keys(b)}).setIgnoreErrors(!0);c.listen("done",function(d){for(var b=0,c=a.length;b<c;++b){var e=h.get(a[b]);e&&e.userid&&k.hasSigil(a[b],"online-icon")&&d[e.userid]==n||k.hasSigil(a[b],"mobile-icon")&&d[e.userid]==o?g.show(a[b]):g.hide(a[b])}});c.listen("finally",function(a){clearTimeout(p),p=l(q,m)});c.send()}m=m?m*100:6e4;q()}),null);
__d("MobileZeroRewriteURL",["MChannelManager"],(function(a,b,c,d,e,f,g){__p&&__p();var h=null,i=null;function a(a){__p&&__p();if(!a)return;h=a.regex_matcher;i=a.regex_replacer;for(var a=0;a<h.length;a++){var b=h[a];b.indexOf("^")===0&&(b=b.substr(1));b=new RegExp(b,"i");h[a]=b}g.setTransform(j)}function j(a){if(!h)return a;k(a);return a}function k(a){if(!a)return;if(Array.isArray(a))for(var b=0;b<a.length;b++)l(a,b);else for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&l(a,c)}function l(a,b){var c=a[b],d=typeof c;d==="object"?k(c):d==="string"&&c.indexOf("<img")>=0&&(c=c.replace(/<img[^>]*>/gi,function(a){for(var b=0;b<h.length;b++){var c=h[b];if(c.test(a))return a.replace(c,i[b])}return a}),a[b]=c)}f.main=a}),null);
__d("XQuickPromotionSimpleLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/qp/action/log/",{qp_id:{type:"Int",required:!0},qp_action:{type:"Enum",enumType:1},qp_instance_log_data:{type:"StringToStringMap",defaultValue:{}},qp_event:{type:"String"}})}),null);