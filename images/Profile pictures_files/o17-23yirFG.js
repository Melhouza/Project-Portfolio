if (self.CavalryLogger) { CavalryLogger.start_js(["ka3dx"]); }

__d("MSnowflakeJSConstants",[],(function(a,b,c,d,e,f){e.exports={INIT_PATH:"/photos/snowflake/init/",PAGE_PATH:"/photos/snowflake/page/",VIEWER_INIT_BATCH_SIZE:6,VIEWER_PAGE_BATCH_SIZE:10}}),null);
__d("ClientTrackingMessage",[],(function(a,b,c,d,e,f){__p&&__p();function g(){"use strict";this.message={}}g.prototype.addTrackingMessage=function(a){"use strict";Object.assign(this.message,a)};g.prototype.getAppendedTrackingData=function(){"use strict";return Object.keys(this.message).map(function(a){var b=this.message[a];Array.isArray(b)&&(b=JSON.stringify(b));return a+"."+b}.bind(this)).join(":")};g.prototype.appendToURI=function(a){"use strict";a.addQueryData(g.URI_KEY,this.getAppendedTrackingData())};g.URI_KEY="_ft_";e.exports=g}),null);
__d("MDateString",["fbt"],(function(a,b,c,d,e,f,g){__p&&__p();var h=86400;function i(a){return a instanceof Date?a:new Date(a*1e3)}function j(a,b,c){a=a.toString();c=c||"0";while(a.length<b)a=c+a;return a}function k(a,b){a=i(a);b=i(b);return a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate()}function l(a){return a.getFullYear()===new Date().getFullYear()}function m(a){a=i(a);var b=a.getHours(),c=b>=12;b=b;b===0?b=12:b>12&&(b-=12);a=j(a.getMinutes(),2);return g._("{hours}:{minutes} {ampm}",[g._param("hours",b),g._param("minutes",a),g._param("ampm",c?"PM":"AM")])}function n(a,b){a=a||new Date();b=b||{};b=b.zero_padding?2:1;return g._("{date}\/{month}\/{year}",[g._param("month",j(a.getMonth()+1,b)),g._param("date",j(a.getDate(),b)),g._param("year",(a.getFullYear()+"").substr(-2))])}var o=[g._("Sun"),g._("Mon"),g._("Tues"),g._("Wed"),g._("Thurs"),g._("Fri"),g._("Sat")],p=[g._("Sunday"),g._("Monday"),g._("Tuesday"),g._("Wednesday"),g._("Thursday"),g._("Friday"),g._("Saturday")],q=[g._("Jan"),g._("Feb"),g._("Mar"),g._("Apr"),g._("May"),g._("Jun"),g._("Jul"),g._("Aug"),g._("Sept"),g._("Oct"),g._("Nov"),g._("Dec")],r=[g._("January"),g._("February"),g._("March"),g._("April"),g._("May"),g._("June"),g._("July"),g._("August"),g._("September"),g._("October"),g._("November"),g._("December")];function s(a,b){a=i(a).getDay();return b?o[a]:p[a]}function t(a,b){a=i(a).getMonth();return b?q[a]:r[a]}function u(){return Date.now()/1e3|0}function a(c,d){__p&&__p();if(c==-1)return g._("Just now");else if(c===0)return"";var e=u(),f=new Date(c*1e3),i=e-c|0,j=i/60|0,o=j/60|0,a=o/24|0,b=a/30.4|0,q=a/365|0;d=d||{};var v=d.compact||!1,w=d.relative!==undefined?d.relative:i<=h;d=d.show_cur_year!==undefined?d.show_cur_year:!0;if(w){w={year:q,month:b,day:a,hr:o,min:j,sec:i};for(var x in w){q=w[x];if(q!==0){b=Math.abs(q);if(b==1&&!v)switch(x){case"year":return g._("over a year ago");case"month":return g._("about a month ago");case"day":return g._("about a day ago");case"hr":return g._("about an hour ago");case"min":return g._("about a minute ago");case"sec":return g._("A few seconds ago")}if(v)switch(x){case"year":return g._({"*":"{number} yr"},[g._param("number",b,[0])]);case"month":return g._({"*":"{number} mo"},[g._param("number",b,[0])]);case"day":return g._({"*":"{number} d"},[g._param("number",b,[0])]);case"hr":return g._({"*":"{number} hr"},[g._param("number",b,[0])]);case"min":return g._({"*":"{number} min"},[g._param("number",b,[0])]);case"sec":return g._({"*":"{number} sec"},[g._param("number",b,[0])])}else switch(x){case"year":return g._({"*":"{number} years ago"},[g._param("number",b,[0])]);case"month":return g._({"*":"{number} months ago"},[g._param("number",b,[0])]);case"day":return g._({"*":"{number} days ago"},[g._param("number",b,[0])]);case"hr":return g._({"*":"{number} hours ago"},[g._param("number",b,[0])]);case"min":return g._({"*":"{number} minutes ago"},[g._param("number",b,[0])]);case"sec":return g._({"*":"{number} seconds ago"},[g._param("number",b,[0])])}}}return g._("Just now")}else{if(v)if(k(e,f))return m(f);else if(e-h*7<c)return s(f,!0);else return n(f);if(k(e,f))return g._("Today at {time}",[g._param("time",m(f))]);else if(k(e-h,f))return g._("Yesterday at {time}",[g._param("time",m(f))]);else if(k(e-h*2,f)||k(e-h*3,f))return g._("{weekday} at {time}",[g._param("weekday",s(f)),g._param("time",m(f))]);else if(e-h*7<c)return g._("{month} {date}",[g._param("month",t(f,!0)),g._param("date",f.getDate())]);else if(!d&&l(f))return g._("{month} {date}",[g._param("month",t(f,!0)),g._param("date",f.getDate())]);else return g._("{month} {date}, {year}",[g._param("month",t(f,!0)),g._param("date",f.getDate()),g._param("year",f.getFullYear())])}}function b(a){return g._("{month} {date}, {year}",[g._param("month",t(a,!0)),g._param("date",a.getDate()),g._param("year",a.getFullYear())])}function c(a){a=a||new Date();return n(a,{zero_padding:!0})+" "+m(a)}function d(a){var b=3600;return Math.floor(a/b/1e3)*b}e.exports={dateIsSameDay:k,displayTime:a,displayDate:b,displayExactTime:c,getMonth:t,getWeekday:s,roundTimestampToHour:d}}),null);
__d("MTimestamp.react",["MDateString","MTimestamp","React","ReactDOM","Stratcom","SubscriptionsHandler","forEachObject"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";__p&&__p();var n;b=i.PropTypes;var o=2e4,p,q={},r=0,s;function t(a){var b="ts_"+r++;q[b]=a;Object.keys(q).length===1&&(s=new l(),s.addSubscriptions(k.listen("m:page:unload",null,function(){return Object.keys(q).forEach(y)}),k.listen("m:update-timestamps",null,function(){w(),x(),v()})),v());return b}function u(a){var b=h.renderTimestamp(Math.floor((Date.now()-a)/1e3),!1);return!b?g.displayTime(a/1e3,{compact:!1,show_cur_year:!1}):b}function v(){p=setInterval(x,o)}function w(){p!=null&&clearInterval(p)}function x(){j.unstable_batchedUpdates(function(){return m(q,function(a){return a.setState({displayTime:u(a.props.timestamp)})})})}function y(a){delete q[a],Object.keys(q).length===0&&(w(),s&&s.release(),s=null)}c=babelHelpers.inherits(a,i.Component);n=c&&c.prototype;function a(a){n.constructor.call(this,a),this.state={displayTime:u(a.timestamp)}}a.prototype.componentDidMount=function(){this.$1=t(this)};a.prototype.UNSAFE_componentWillReceiveProps=function(a){this.props.timestamp!==a.timestamp&&this.setState({displayTime:u(a.timestamp)})};a.prototype.componentWillUnmount=function(){y(this.$1)};a.prototype.render=function(){return i.createElement("abbr",this.props,this.state.displayTime)};a.propTypes={timestamp:b.number.isRequired};e.exports=a}),null);
__d("getActorFirstName",[],(function(a,b,c,d,e,f){function g(a){for(var b=0;b<a.length;b++)if(a[b].part=="first")return a[b]}function a(a){var b=a.text;a=g(a.parts);return a?b.substr(a.offset,a.length):b}e.exports=a}),null);
__d("PhotoSetStoreCore",["KeyedCallbackManager"],(function(a,b,c,d,e,f,g){__p&&__p();var h={_controller:new g(),getBySetToken:function(a,b){this._controller.executeOrEnqueue(a,b)},getLoadedPhotoSetTokens:function(){return Object.keys(this._controller.getAllResources())},getBySetTokenImmediate:function(a){return this._controller.getResource(a)},updateData:function(a){var b=a.photo_set;b={icon:b.icon,editURL:b.edit_url,title:b.title,contributors:b.contributors,owner:b.owner,contributorsElem:b.contributors_elem,facepileElem:b.facepile_elem,modifiedTime:b.modified_time,message:b.message,mediaCount:b.media_count,ufi:b.ufi,url:b.url,story:b.story,titleCardStyle:b.title_card_style,permalink:b.permalink,feedbackTarget:b.feedback_target,feedback:b.feedback,referrerType:b.referrer_type,taggingTypeaheadConfig:b.tagging_typeahead_config,taggingTypeaheadSuggestions:b.tagging_typeahead_suggestions,reportFlow:b.report_flow};var c={};c[a.set_token]=b;this._controller.addResourcesAndExecute(c)},updateFeedbackData:function(a){var b=Object.keys(a),c=h.getLoadedPhotoSetTokens();c.forEach(function(c){var d=h.getBySetTokenImmediate(c);b.includes(d.feedbackTarget)&&h._controller.setResource(c,babelHelpers["extends"]({},d,{feedback:a[d.feedbackTarget].feedback}))})},updatePhotoSetStoryFeedbackData:function(a){var b=Object.keys(a);b.forEach(function(b){var c=h.getBySetTokenImmediate(b);if(!c||!c.story)return;h._controller.setResource(b,babelHelpers["extends"]({},c,{story:babelHelpers["extends"]({},c.story,{feedback:a[b].feedback})}))})},reset:function(){this._controller.reset()}};e.exports=h}),null);
__d("MPhotoSetStore",["PhotoSetStoreCore","Stratcom"],(function(a,b,c,d,e,f,g,h){h.listen("m:photosetstore:update",null,function(event){g.updateData(event.getData())}),h.listen("m:page:unload-complete",null,function(event){g.reset()}),h.listen("m:photosetstore:reset",null,function(){g.reset()}),h.listen("m:photosetstore:updatestoryfeedback",null,function(event){g.updatePhotoSetStoryFeedbackData(event.getData())}),h.listen("m:photosetstore:updatefeedback",null,function(event){g.updateFeedbackData(event.getData())}),e.exports=g}),null);
__d("PhotoStoreCore",[],(function(a,b,c,d,e,f){__p&&__p();var g={actions:{UPDATE:"update"},_photoCache:{},_postCreateCallbacks:{},getPhotoCache:function(a){if(!this._photoCache[a])throw new Error("Photo cache requested for unknown set ID");return this._photoCache[a]},hasBeenCreated:function(a){return!!this._photoCache[a]},clearSetCache:function(a){delete this._photoCache[a],delete this._postCreateCallbacks[a]},getByIndex:function(a,b,c){this.getPhotoCache(a).getItemAtIndex(b,c)},getByIndexImmediate:function(a,b){return this._photoCache[a]?this._photoCache[a].getItemAtIndexImmediate(b):undefined},getItemsInAvailableRange:function(a){var b=this.getAvailableRange(a),c=[];for(var d=b.offset;d<b.length;d++)c.push(this.getByIndexImmediate(a,d));return c},getItemsAfterIndex:function(a,b,c,d){b=this.getCursorByIndexImmediate(a,b);this.fetchForward(a,b,c,d)},getAllByIDImmediate:function(a){var b=Object.keys(this._photoCache);return b.map(function(b){return this.getByIndexImmediate(b,this.getIndexForID(b,a))}.bind(this)).filter(function(a){return!!a})},getIndexForID:function(a,b){return this._photoCache[a]?this._photoCache[a].getIndexForID(b):undefined},getEndIndex:function(a){a=this.getAvailableRange(a);return a.offset+a.length-1},getCursorByIndexImmediate:function(a,b){b=this.getByIndexImmediate(a,b);return b?this._photoCache[a].getCursorForID(b.id):undefined},hasNextPage:function(a){var b=this.getCursorByIndexImmediate(a,this.getEndIndex(a));return this.getPhotoCache(a).hasNextPage(b)},getAvailableRange:function(a){return this.getPhotoCache(a).getAvailableRange()},hasLooped:function(a){return this.getPhotoCache(a).hasLooped()},fetchForward:function(a,b,c,d){this.getPhotoCache(a).getItemsAfterCursor(b,c,d)},fetchBackward:function(a,b,c,d){this.getPhotoCache(a).getItemsBeforeCursor(b,c,d)},executePostCreate:function(a,b){this._photoCache[a]?b&&b():this._postCreateCallbacks[a]=b},runPostCreateCallback:function(a){var b=this._postCreateCallbacks[a];b&&(b(),delete this._postCreateCallbacks[a])},setPreFetchCallback:function(a,b){this.getPhotoCache(a).setPreFetchCallback(b)},updateData:function(a){var b=a.set_id;!this._photoCache[b]?(this._photoCache[b]=new a.cache_class(a),this.runPostCreateCallback(b)):a.query_metadata.action==g.actions.UPDATE?this._photoCache[b].updateData(a):this._photoCache[b].addData(a)},updateFeedbackData:function(a){var b=Object.keys(a);b.forEach(function(b){return g.getAllByIDImmediate(b).forEach(function(c){c.feedback=a[b].feedback})})},reset:function(){Object.keys(this._photoCache).forEach(function(a){return this.clearSetCache(a)}.bind(this))}};e.exports=g}),null);
__d("MPhotoStore",["PhotoStoreCore","Stratcom"],(function(a,b,c,d,e,f,g,h){h.listen("m:photostore:update",null,function(event){g.updateData(event.getData())}),h.listen("m:page:unload-complete",null,function(event){g.reset()}),h.listen("m:photostore:reset",null,function(){g.reset()}),h.listen("m:photostore:updatefeedback",null,function(event){g.updateFeedbackData(event.getData())}),e.exports=g}),null);
__d("MPhotoCentralUpdates",["Stratcom","MPhotoStore","MPhotoSetStore"],(function(a,b,c,d,e,f,g){b("MPhotoStore");b("MPhotoSetStore");a={handleUpdate:function(a,b){a=babelHelpers["extends"]({payloadsource:a},b);g.invoke("m:photostore:update",null,a);g.invoke("m:photostore:afterupdate",null,a)},handlePhotoSets:function(a,b){a=babelHelpers["extends"]({payloadsource:a},b);g.invoke("m:photosetstore:update","store",a)}};e.exports=a}),null);
__d("MLinkTracking",["ClientTrackingMessage","MLinkHack","URI","collectDataAttributes","isFacebookURI"],(function(a,b,c,d,e,f,g,h,i,j,k){__p&&__p();function a(a){__p&&__p();var b=l(a);if(!b)return;h.remove(a);var c=a.getAttribute("href");if(c&&c.indexOf("#")!==0){var d=new i(c);if(!k(d))return;var e=new g();e.addTrackingMessage(b);e.appendToURI(d);c=d.toString();c&&a.setAttribute("href",c)}}function b(a,b){var c=new i(a.getURI());if(!k(c))return;var d=new g();d.addTrackingMessage(b);d.appendToURI(c);a.setURI(c.toString())}function l(a){a=j(a,["ft"]);if(!a)return;return a.ft}e.exports={addFeedTrackingDataToHref:a,addFeedTrackingDataToRequest:b,getFeedTrackingData:l}}),null);
__d("interleaveArray",[],(function(a,b,c,d,e,f){function a(a,b){a=a.filter(function(a){return a!==undefined});var c=[];a.length>0&&c.push(a[0]);for(var d=1;d<a.length;++d)c.push(b),c.push(a[d]);return c}e.exports=a}),null);
__d("MSnowflakeHeaderMetaData.react",["Image.react","MTimestamp.react","MXUIDiv.react","React","areEqual","cx","fbt","interleaveArray"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){__p&&__p();var o;b=j.PropTypes;c=babelHelpers.inherits(a,j.Component);o=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=o.constructor).call.apply(a,[this].concat(d)),this.renderLocation=function(){return!this.props.location?null:this.props.location}.bind(this),b}a.prototype.shouldComponentUpdate=function(a){"use strict";return!k(this.props,a)};a.prototype.renderUpdatedTime=function(){"use strict";if(!this.props.modifiedTime)return null;var a=j.createElement(h,{timestamp:this.props.modifiedTime});return!this.props.showNewPermalink?a:j.createElement("span",null,m._("Updated: {updatedTimestamp}",[m._param("updatedTimestamp",a)]))};a.prototype.renderPrivacy=function(){"use strict";if(!this.props.privacyScope)return null;var a=null;this.props.showNewPermalink||(a=this.props.privacyScope.label);return j.createElement("span",{className:"_4nj-"},a,j.createElement(g,{className:"_3v9g",src:this.props.privacyScope.icon_image.uri,alt:this.props.privacyScope.label}))};a.prototype.render=function(){"use strict";var a=[this.renderUpdatedTime(),this.renderLocation(),this.renderPrivacy()].filter(function(a){return!!a}),b=j.createElement("span",null," ");this.props.showNewPermalink||(b=j.createElement("span",null," \xb7 "));a=n(a,b);a=a.map(function(a,b){return j.createElement("span",{key:b},a)});return!a.length?j.createElement("span",null):j.createElement(i,{className:"_21h4"},a)};a.propTypes={modifiedTime:b.number,mediaCount:b.number,location:b.string,showNewPermalink:b.bool};e.exports=a}),null);
__d("MSnowflakeTextWithEntities.react",["BaseTextWithEntities.react","Image.react","MEntityLink.react","MTextWithEmoticons.react","React","URI","areEqual"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m){__p&&__p();var n;b=babelHelpers.inherits(a,k.Component);n=b&&b.prototype;function a(){__p&&__p();var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=n.constructor).call.apply(a,[this].concat(d)),this.renderText=function(a){return k.createElement(j,{text:a})},this.renderEntityLink=function(a,b){return k.createElement(i,{rel:"ignore",entity:b},a)},this.getBrowseProfilesURI=function(a){return new l("/browse/users/").addQueryData({ids:a.map(function(a){return a.id})})},this.renderAggregatedEntitiesLink=function(a,b){return k.createElement("a",{href:this.getBrowseProfilesURI(b.sample_entities).toString()},a)}.bind(this),this.renderImage=function(a){return k.createElement(h,{src:a.image.uri,height:a.image.height,width:a.image.width})},this.renderRange=function(a,b){if(b.entity_with_image)return this.renderImage(b.entity_with_image);return b.entity?this.renderEntityLink(a,b.entity):this.renderAggregatedEntitiesLink(a,b)}.bind(this),b}a.prototype.shouldComponentUpdate=function(a){"use strict";return!m(this.props,a)};a.prototype.render=function(){"use strict";var a=this.props.text;return k.createElement(g,babelHelpers["extends"]({},this.props,{textRenderer:this.renderText,rangeRenderer:this.renderRange,text:a.text,aggregatedRanges:a.aggregated_ranges,imageRanges:a.image_ranges,ranges:a.ranges}))};e.exports=a}),null);
__d("MSnowflakeUFIAction.react",["Image.react","React","cx","joinClasses","validateImageSrcPropType"],(function(a,b,c,d,e,f,g,h,i,j,k){__p&&__p();var l;l=babelHelpers.inherits(a,h.Component);l&&l.prototype;a.prototype.shouldComponentUpdate=function(a){"use strict";return this.props.icon!==a.icon};a.prototype.render=function(){"use strict";return h.createElement("a",{onClick:this.props.onClick,rel:this.props.rel,href:this.props.href,className:j("_1w31",this.props.className),"data-testid":this.props["data-testid"]},h.createElement(g,{src:this.props.icon}))};function a(){"use strict";l.apply(this,arguments)}a.propTypes={icon:k};a.defaultProps={href:"#",rel:"ignore"};e.exports=a}),null);
__d("SnowflakeWebDriverIDs",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({HEADER_CARD:"Snowflake/headerCard",OPTIONS_MENU:"Snowflake/optionsMenu",PHOTO_CARD:"Snowflake/photoCard",ROOT:"Snowflake/root",SNOWFLAKE_MORE_ACTION:"snowflake-more-action"})}),null);
__d("XNFXDialogFromIDController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/nfx/report/dialog/",{content_id:{type:"String",required:!0},nfx_location:{type:"String",required:!0}})}),null);
__d("MSnowflakeUFIActionBar.react",["CurrentUser","DOM","FRXEnabledMSite","LeftRight.react","MFlyout","MRequest","MSnowflakeUFIAction.react","MXUIDiv.react","QE2Logger","React","ReactDOM","SnowflakeWebDriverIDs","Vector","XNFXDialogFromIDController","areEqual","cx","fbt","getObjectValues","interleaveArray","ix","MLayerHideOnBlur"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){"use strict";__p&&__p();var A;d=p.PropTypes;var B={DEFAULT:"default",CORNER:"corner"};f=babelHelpers.inherits(c,p.Component);A=f&&f.prototype;function c(){__p&&__p();var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(b=A.constructor).call.apply(b,[this].concat(e)),this.state={shouldTruncateInteractors:!1,maxInteractors:2},this.$4=function(){return this.props.displayStyle===B.CORNER}.bind(this),this.$2=function(){if(!this.$3)return;this.$4()?this.$3.setPosition("below"):this.$3.setPosition("above")}.bind(this),this.checkInteractorsWidth=function(){if(this.refs.interactors){var a=q.findDOMNode(this.refs.interactors),b=q.findDOMNode(this.refs.feedbackCounts),c=q.findDOMNode(this.refs.inlineFeedback);a=s.getElementDimensions(a).y;b=s.getElementDimensions(b).y;c=s.getElementDimensions(c).y;a+b>c&&(!this.state.shouldTruncateInteractors?this.setState({shouldTruncateInteractors:!0}):(this.state.maxInteractors>1||this.getIsUserInteractor&&this.state.maxInteractors>0)&&this.setState({maxInteractors:this.state.maxInteractors-1}))}}.bind(this),this.getReportPhotoURI=function(){return t.getURIBuilder().setString("content_id",this.props.feedbackTarget).setString("nfx_location","photo_viewer").getURI()}.bind(this),this.toggleTagging=function(a){this.props.onToggleTagging(),a.stopPropagation()}.bind(this),this.renderTagAction=function(){if(!this.canCreateTags())return null;var a;this.props.isTaggingMode?a=z("91347"):this.$4()?a=z("91348"):a=z("91346");return p.createElement(m,{key:"tagAction",icon:a,onClick:this.toggleTagging})}.bind(this),this.renderMoreAction=function(){if(!this.hasMoreActions())return null;var a=this.$4()?z("91343"):z("91342");return p.createElement(m,{"data-testid":r.SNOWFLAKE_MORE_ACTION,onClick:function(){o.logExposureForUser("frx_comments_msite_universe")},key:"moreAction",ref:"moreActionButton",icon:a})}.bind(this),this.getLikeCount=function(){return this.props.feedbackData.likers?this.props.feedbackData.likers.count:0}.bind(this),this.getCommentCount=function(){return this.props.feedbackData.comments?this.props.feedbackData.comments.count:0}.bind(this),this.renderFeedbackCount=function(){var a=[this.renderLikeCount(),this.renderCommentCount()];return p.createElement(n,{className:"_2xh_",ref:"feedbackCounts"},y(a," "))}.bind(this),this.renderLikeCount=function(){var a=this.getLikeCount();if(!a)return null;a>1?a=w._({"*":"{likes} likes"},[w._param("likes",a,[0])]):a=w._("{likes} like",[w._param("likes",1)]);return p.createElement("span",{className:"_2xe3",key:"likeCount"},a)}.bind(this),this.renderCommentCount=function(){var a=this.getCommentCount();if(!a)return null;a>1?a=w._({"*":"{comments} Comments"},[w._param("comments",a,[0])]):a=w._("{comments} Comment",[w._param("comments",1)]);return p.createElement("span",{className:"_2xe4",key:"commentCount"},a)}.bind(this),this.hasInteractors=function(){return!!this.getInteractors().length}.bind(this),this.getInteractors=function(){if(!this.props.feedbackData.interactors)return[];var a=this.props.feedbackData.interactors.nodes;a=a.filter(function(a){return a.id!==g.getID()});return a}.bind(this),this.getInteractorsCount=function(){return!this.props.feedbackData.interactors?0:this.props.feedbackData.interactors.count}.bind(this),this.getIsUserInteractor=function(){return this.props.feedbackData.does_viewer_like||this.props.feedbackData.has_viewer_commented_recently}.bind(this),this.renderInteractors=function(){__p&&__p();var a=this.getIsUserInteractor(),b=this.getInteractors().map(function(a){return a.name});if(a){a=w._("You");b.splice(0,0,a)}a=this.getInteractorsCount();if(a===0)return null;else if(a==1)return b[0];else if(!this.state.shouldTruncateInteractors&&a==b.length){var c=b[a-1],d=b.slice(0,a-1).join(", ");return w._("{seperatedInteractors} and {lastInteractor}",[w._param("seperatedInteractors",d),w._param("lastInteractor",c)])}else{d=this.state.maxInteractors;c=a-d;a=b.slice(0,d).join(", ");if(d===0)return null;else return w._("{firstInteractors} and {moreCount} more",[w._param("firstInteractors",a),w._param("moreCount",c)])}}.bind(this),this.renderFeedbackSocialText=function(){if(!this.hasInteractors()){if(this.getCommentCount()||this.getLikeCount())return p.createElement(n,null,w._("Write a comment"))}else return p.createElement(n,{className:"_2g6d",ref:"interactors"},this.renderInteractors());return null}.bind(this),this.notImplementedMessage=function(b){b.stopPropagation(),a.alert("Not yet implemented")},this.hasMoreActions=function(){return this.props.canReport||this.props.editURL}.bind(this),this.$6=function(a){return p.createElement("div",{className:"_51cd"},p.createElement(j,{className:"_2xi0",ref:"inlineFeedback"},p.createElement(n,{ref:"actions",className:"_2j65"},a),p.createElement(n,{onClick:this.props.onToggleComments},this.renderFeedbackCount(),this.renderFeedbackSocialText())))}.bind(this),c}c.prototype.shouldComponentUpdate=function(a,b){return!u(this.props,a)||!u(this.state,b)};c.prototype.componentDidUpdate=function(a,b){this.checkInteractorsWidth(),this.$2()};c.prototype.componentDidMount=function(){this.checkInteractorsWidth(),this.hasMoreActions()&&(this.$1=h.create("div"),q.render(this.renderMoreActionBubble(),this.$1),this.$3=new k({nubalign:"center",offsetY:0,position:this.$4()?"below":"above",margin:"medium",width:"auto",addedBehaviors:[b("MLayerHideOnBlur")],context:q.findDOMNode(this.refs.moreActionButton)},this.$1))};c.prototype.componentWillUnmount=function(){this.$3&&(this.$3.destroy(),this.$3=null),this.$1&&(q.unmountComponentAtNode(this.$1),delete this.$1)};c.prototype.renderReportItem=function(){if(!this.props.canReport)return p.createElement(n,null);var a;this.props.isPhoto&&!this.props.isPlayable?a=w._("Report photo"):a=w._("Report");i.frxEnabled&&(this.props.isPhoto&&!this.props.isPlayable?a=w._("Give feedback or report photo"):a=w._("Give feedback or report video"));return p.createElement(n,{className:"_55i1 _58a0",onClick:function(){return new l(this.getReportPhotoURI()).send()}.bind(this)},a)};c.prototype.renderEditItem=function(){return!this.props.editURL?null:this.renderActionBubble(this.props.editURL,this.props.isAlbum?w._("Edit album"):w._("Edit photo"))};c.prototype.renderDeletePhotoItem=function(){return!this.props.deleteURL||!this.props.isPhoto?null:this.renderActionBubble(this.props.deleteURL,w._("Delete photo"))};c.prototype.renderActionBubble=function(a,b){return p.createElement("a",{rel:"ignore",href:a,className:"_55i1 _58a0"},b)};c.prototype.renderMoreActionBubble=function(){return p.createElement(n,{className:"_55i2","data-testid":r.OPTIONS_MENU},this.renderEditItem(),this.renderReportItem(),this.renderDeletePhotoItem())};c.prototype.canCreateTags=function(){return!!this.props.canCreateTags};c.prototype.$5=function(a){return p.createElement("div",{className:"_40qv"},a)};c.prototype.render=function(){var a=[this.renderTagAction(),this.renderMoreAction()].filter(function(a){return!!a});if(!a.length)return null;if(this.$4())return this.$5(a);else return this.$6(a)};c.DISPLAY_STYLES=B;c.propTypes={displayStyle:d.oneOf(x(B)),editURL:d.string,isTaggingMode:d.bool.isRequired,isAlbum:d.bool,isPhoto:d.bool,isPlayable:d.bool,canCreateTags:d.bool,feedbackTarget:d.string,feedbackData:d.object.isRequired,onToggleTagging:d.func.isRequired,onToggleComments:d.func.isRequired,hasPrerenderedActionsUFI:d.bool};c.defaultProps={displayStyle:B.DEFAULT};e.exports=c}),null);
__d("MSnowflakeUFI.react",["CSS","DOM","DOMContainer.react","MSnowflakeUFIActionBar.react","MXUIDiv.react","React","SnowflakeWebDriverIDs","areEqual","csx","cx","emptyFunction"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){"use strict";__p&&__p();var r;b=l.PropTypes;var s="inline-action-bar";c=babelHelpers.inherits(a,l.Component);r=c&&c.prototype;function a(){__p&&__p();var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=r.constructor).call.apply(a,[this].concat(d)),this.state={collapsed:this.props.initialIsCollapsed},this.toggleCollapsed=function(){this.setState({collapsed:!this.state.collapsed,focusComments:!0})}.bind(this),this.focusComments=function(){this.setState({collapsed:!1,focusComments:!0})}.bind(this),this.$1=function(){var a=h.scry(this.props.ufi,"*",s);a=a.length&&a[0];return a||null}.bind(this),this.renderPrerenderedUFI=function(){var a=this.props.ufi;if(!a)return null;var b=this.$1();b&&g.addClass(b,"_1dia");b="_2xi1"+(this.state.collapsed?" _2xi2":"");return l.createElement(k,{className:b,"data-testid":m.UFI},l.createElement(i,null,a))}.bind(this),b}a.prototype.shouldComponentUpdate=function(a,b){return!n(this.props,a)||!n(this.state,b)};a.prototype.componentDidUpdate=function(a,b){this.state.focusComments&&(this.props.ufi&&(this.props.ufi.scrollIntoView(!1),this.props.ufi.querySelector("._uwx").focus()),this.setState({focusComments:!1}))};a.prototype.renderActionBar=function(){var a=this.props.feedbackUpdatingParams,b=a.isPhoto;a=a.isPlayable;var c=b?j.DISPLAY_STYLES.CORNER:j.DISPLAY_STYLES.DEFAULT;return l.createElement(j,{displayStyle:c,isAlbum:this.props.isAlbum,isPhoto:b,isPlayable:a,editURL:this.props.editURL,deleteURL:this.props.deleteURL,isTaggingMode:this.props.isTaggingMode,imageSizeReductionFactor:this.props.imageSizeReductionFactor,canReport:this.props.canReport,canCreateTags:this.props.canCreateTags,feedbackTarget:this.props.feedbackTarget,feedbackData:this.props.feedbackData,onToggleTagging:this.props.onToggleTagging,onToggleComments:this.focusComments})};a.prototype.render=function(){return l.createElement(k,null,this.renderActionBar(),this.renderPrerenderedUFI())};a.propTypes={isShareable:b.bool,isAlbum:b.bool,editURL:b.string,deleteURL:b.string,isTaggingMode:b.bool,initialIsCollapsed:b.bool,canCreateTags:b.bool,ufi:b.instanceOf(HTMLElement),feedbackTarget:b.string,feedbackData:b.object.isRequired,feedbackUpdatingParams:b.shape({isAlbum:b.bool,isPhoto:b.bool,isPhotoSetStory:b.bool,isPlayable:b.bool,targetKey:b.string.isRequired}).isRequired,onToggleTagging:b.func};a.defaultProps={isShareable:!1,isTaggingMode:!1,canCreateTags:!1,initialIsCollapsed:!0,onToggleTagging:q};e.exports=a}),null);
__d("MSnowflakeAlbumHeaderCard.react",["CssBackgroundImage.react","DOMContainer.react","MEntityLink.react","MImage.react","MSnowflakeHeaderMetaData.react","MSnowflakeTextWithEntities.react","MSnowflakeUFI.react","MXUICard.react","MXUIDiv.react","MXUISpan.react","React","SnowflakeWebDriverIDs","areEqual","cx","interleaveArray"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){__p&&__p();var v;b=q.PropTypes;c=b.object;d=babelHelpers.inherits(a,q.Component);v=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=v.constructor).call.apply(a,[this].concat(d)),this.renderMessage=function(){return!this.props.message?null:q.createElement(o,{className:"_26p9"},q.createElement(l,{text:this.props.message}))}.bind(this),this.renderUFI=function(){return q.createElement(m,{ufi:this.props.ufi,feedbackTarget:this.props.feedbackTarget,feedbackUpdatingParams:{isAlbum:!0,targetKey:this.props.feedbackTarget},isShareable:!0,feedbackData:this.props.feedback,initialIsCollapsed:this.props.initialIsUFICollapsed})}.bind(this),this.renderTitle=function(){var a=this.props.title;a&&a.text&&(a=a.text);return q.createElement(o,{className:"_9j8"},a)}.bind(this),b}a.prototype.shouldComponentUpdate=function(a){"use strict";return!s(this.props,a)};a.prototype.renderMetaData=function(){"use strict";return q.createElement(k,{location:this.props.location,modifiedTime:this.props.modifiedTime,mediaCount:this.props.mediaCount,privacyScope:this.props.privacyScope,showNewPermalink:this.props.showNewPermalink})};a.prototype.renderContributors=function(){"use strict";__p&&__p();if(!this.props.contributors||!this.props.contributors.length)return null;if(!this.props.showNewPermalink){var a=[this.props.owner].concat(this.props.contributors.filter(function(a){return a.id!==this.props.owner.id}.bind(this)));a=u(a.map(function(a,b){return q.createElement(p,{className:"_5v15",key:b},q.createElement(i,{entity:a},a.name))}),", ");return q.createElement(o,{className:"_5v16"},"By ",a)}else{if(this.props.contributors.length<2)return null;a=this.props.contributors.map(function(a,b){return q.createElement(i,{entity:a,key:b,className:"_187c"},q.createElement(j,{className:"_187e",height:32,src:a.profile_picture.uri,width:32}))});return q.createElement(o,{className:"_189o"},a)}};a.prototype.renderFollowButton=function(){"use strict";return!this.props.followButton?null:q.createElement(h,null,this.props.followButton)};a.prototype.renderCoverSection=function(){"use strict";return!this.props.showNewPermalink?null:q.createElement(o,{className:"_189r"},q.createElement(g,{backgroundPosition:"50% 25%",className:"_189s",imageURI:this.props.coverPhotoSrc}),this.renderFollowButton())};a.prototype.render=function(){"use strict";var a=q.createElement(o,{className:"_tmc"},this.renderCoverSection(),this.renderTitle(),this.renderMetaData(),this.renderMessage(),this.renderContributors());this.props.showNewPermalink||(a=q.createElement(o,{className:"_tmc"},this.renderCoverSection(),this.renderTitle(),this.renderContributors(),this.renderMessage(),this.renderMetaData()));return q.createElement(o,{className:(this.props.showNewPermalink?"":"_189t")+(this.props.showNewPermalink?" _189u":"")},q.createElement(n,{className:"_4zvh","data-testid":r.HEADER_CARD},a,this.renderUFI()))};a.propTypes={feedbackTarget:b.string.isRequired,feedback:b.object.isRequired,message:b.object,modifiedTime:b.number,mediaCount:b.number,title:b.oneOfType([b.string,c]).isRequired,contributors:b.arrayOf(b.object),owner:b.object,initialIsUFICollapsed:b.bool,ufi:b.instanceOf(HTMLElement),followButton:b.instanceOf(HTMLElement),coverPhotoSrc:b.string,showNewPermalink:b.bool};e.exports=a}),null);
__d("MSnowflakePagerCard.react",["FullBleedFeedQE","MLoadingSpinner.react","MXUICard.react","MXUIDiv.react","OnVisible.react","React","cx"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m){__p&&__p();var n;n=babelHelpers.inherits(a,l.Component);n&&n.prototype;a.prototype.render=function(){"use strict";if(g.fullBleed)return l.createElement(j,{className:"_45_8"},l.createElement(k,{onVisible:this.props.onFetchMore},l.createElement(h,null)));else return l.createElement(i,{className:"_45_8"},l.createElement(k,{onVisible:this.props.onFetchMore},l.createElement(h,null)))};function a(){"use strict";n.apply(this,arguments)}e.exports=a}),null);
__d("MSnowflakePhotoCardFacebox.react",["React","ShimButton.react","cx"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j;b=g.PropTypes;c=babelHelpers.inherits(a,g.Component);j=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=j.constructor).call.apply(a,[this].concat(d)),this.$1=function(){this.props.onFaceboxSelected&&this.props.onFaceboxSelected(this.props.facebox)}.bind(this),b}a.prototype.render=function(){"use strict";var a=this.props.facebox;a={top:a.top+"%",left:a.left+"%",width:a.width+"%",height:a.height+"%"};return g.createElement(h,{className:"_5piq",onClick:this.$1,style:a})};a.propTypes={facebox:b.object,onFaceboxSelected:b.func};e.exports=a}),null);
__d("MSnowflakePhotoCardTagArrowDirection",["keyMirror"],(function(a,b,c,d,e,f,g){a=g({UP:null,DOWN:null,LEFT:null,RIGHT:null,UP_RIGHT:null,DOWN_LEFT:null,UP_LEFT:null,DOWN_RIGHT:null,NO_DIRECTION:null});e.exports=a}),null);
__d("MSnowflakePhotoCardTag.react",["MeasuredComponent.react","MSnowflakePhotoCardTagArrowDirection","React","ShimButton.react","cx","emptyFunction"],(function(a,b,c,d,e,f,g,h,i,j,k,l){__p&&__p();var m;b=i.PropTypes;c=babelHelpers.inherits(a,i.Component);m=c&&c.prototype;function a(a){"use strict";__p&&__p();m.constructor.call(this,a);this.updateClientRect=function(a){this.setState({clientRect:a}),this.props.onTagMeasured&&this.props.onTagMeasured(this.props.facebox,a)}.bind(this);this.getAdjustedPosition=function(){__p&&__p();var a=this.props.parentRect,b=a.width;a=a.height;var c,d;if(this.props.position)c=this.props.position.left,d=this.props.position.top;else{var e=this.state.defaultLeft*b/100,f=this.state.defaultTop*a/100;c=e;d=f;if(this.state.clientRect){var g=this.state.clientRect.width,h=this.state.clientRect.height;c=Math.max(0,e-g/2);c=Math.min(c,b-g);Math.max(0,f-h/2);d=Math.min(f,a-h)}}return{left:c/b*100,top:d/a*100}}.bind(this);this.renderDeleteButton=function(a){return!this.props.canDelete?null:i.createElement(j,{className:"_e3j","data-sigil":"touchable",onClick:function(){return this.props.onTagDelete(a)}.bind(this)})}.bind(this);a=a.facebox;this.state={defaultLeft:a.x,defaultTop:a.top+a.height,realPosition:!1,clientRect:null}}a.prototype.render=function(){"use strict";var a=this.props.facebox,b=this.getAdjustedPosition();b={left:b.left+"%",top:b.top+"%",visibility:this.state.clientRect?"visible":"hidden"};return i.createElement(g,{onMeasure:this.updateClientRect},i.createElement("div",{className:"_e3g"+(this.props.tagArrowDirection===h.UP?" _1gvp":""),style:b},i.createElement("div",{className:"_e3h"},a.tagName),this.renderDeleteButton(a)))};a.propTypes={facebox:b.object.isRequired,position:b.object,tagArrowDirection:b.string,onTagDelete:b.func.isRequired,onTagMeasured:b.func,parentRect:b.object.isRequired,canDelete:b.bool};a.defaultProps={onTagDelete:l,canDelete:!0,tagArrowDirection:h.UP};e.exports=a}),null);
__d("getScrollPosition",["getDocumentScrollElement","getUnboundedScrollPosition"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();function a(a){var b=g(a.ownerDocument||a.document);a.Window&&a instanceof a.Window&&(a=b);var c=h(a);b=a===b?a.ownerDocument.documentElement:a;var d=a.scrollWidth-b.clientWidth;a=a.scrollHeight-b.clientHeight;c.x=Math.max(0,Math.min(c.x,d));c.y=Math.max(0,Math.min(c.y,a));return c}e.exports=a}),null);
__d("MSnowflakePhotoCardTagger.react",["FamilyTaggingConfig","MeasuredComponent.react","MSnowflakePhotoCardFacebox.react","MSnowflakePhotoCardTag.react","MTaggerTypeaheadPresenter.react","MTagSuggestionsController","MTokenizer.react","React","ReactDOM","Vector","areEqual","cx","fbt","getElementPosition","getScrollPosition"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){__p&&__p();var v;b=n.PropTypes;var w=200,x=10;c=babelHelpers.inherits(a,n.Component);v=c&&c.prototype;function a(a){"use strict";__p&&__p();v.constructor.call(this,a);this.hasTags=function(){return this.hasTagsWithoutFaceboxes()||this.hasTaggedFaceboxes()}.bind(this);this.hasTagsWithoutFaceboxes=function(){return Object.keys(this.state.tags).length}.bind(this);this.hasTaggedFaceboxes=function(){return Object.keys(this.state.faceboxes).any(function(a){return!!this.state.faceboxes[a].tagUserID}.bind(this))}.bind(this);this.resetTokenizer=function(){this.setState({activeFacebox:null})}.bind(this);this.$1=function(a){this.needFocus=!0,this.setState({activeFacebox:a})}.bind(this);this.$2=function(){this.setState({activeFacebox:null})}.bind(this);this.$3=function(a){__p&&__p();this.refs.tokenizer.setEntries([]);var b=this.state.activeFacebox;l.addFaceboxData(b,a.name,a.id);if(b.fbid){a=this.state.faceboxes;a[b.fbid]=b;this.setState({activeFacebox:null,faceboxes:a})}else{a=this.state.tagsWithoutFaceboxes;a[b.tagUserID]=b;this.setState({activeFacebox:null,tagsWithoutFaceboxes:a})}this.props.onTagAdd&&this.props.onTagAdd(b)}.bind(this);this.$4=function(){__p&&__p();var a={display:"none"},b={},c=this.state.activeFacebox;if(this.state.activeFacebox){var d=this.state.clientRect.width,e=d*c.width/100,f=c.left*d/100;a={top:c.top+c.height+"%",width:w};f=f+(e-w)/2;f=Math.max(0,f);f=Math.min(f,d-w);a.left=f;e=this.state.faceboxes;for(var h in e)c=e[h],c.tagUserID&&(b[c.tagUserID]=!0);Object.keys(this.state.tagsWithoutFaceboxes).forEach(function(a){return b[a]=!0})}d=s._("Start typing a name...");f=g.gk;return n.createElement("div",{style:a,className:"_4uod"},n.createElement(m,{ref:"tokenizer",presenter:k,typeaheadConfig:this.props.typeaheadConfig,hideSelected:!0,suggestions:this.props.typeaheadSuggestions,onAdd:this.$3,includeFamilyTags:f,excludedEntries:b,placeholder:d,maxSuggestionCount:x}))}.bind(this);this.$5=function(a){return!this.state.clientRect?null:n.createElement(j,{canDelete:a.canRemove,key:a.tagUserID,parentRect:this.state.clientRect,facebox:a,onTagDelete:this.onTagDelete})}.bind(this);this.$6=function(a){return n.createElement(i,{key:a.fbid,facebox:a,onFaceboxSelected:this.$1})}.bind(this);this.handleImageClick=function(a){a.stopPropagation();if(this.state.activeFacebox)this.$2();else if(this.props.freeformTagging){var b=t(o.findDOMNode(this));u(window);a=new p(a.clientX,a.clientY).sub(p.from(b.x,b.y));this.createFreeFormTag(a.x,a.y)}}.bind(this);this.createFreeFormTag=function(a,b){var c=this.state.clientRect;a={x:a/c.width*100,y:b/c.height*100,width:10,height:10,left:(a-5)/c.width*100,top:(b-5)/c.height*100,recognitions:[]};this.$1(a)}.bind(this);this.updateClientRect=function(a){this.setState({clientRect:a})}.bind(this);this.onTagDelete=function(a){this.props.onTagDelete&&this.props.onTagDelete(a);var b=this.state.faceboxes;a.fbid?(l.deleteFaceboxData(a),b[a.fbid]=a,this.setState({faceboxes:b})):(delete this.state.tagsWithoutFaceboxes[a.tagUserID],this.setState({tagsWithoutFaceboxes:this.state.tagsWithoutFaceboxes}))}.bind(this);var b={};a.initialFaceboxes&&Object.assign(b,a.initialFaceboxes);this.state={faceboxes:b,tagsWithoutFaceboxes:a.initialTags||{},activeFacebox:null,clientRect:null}}a.prototype.UNSAFE_componentWillReceiveProps=function(a){"use strict";q(this.state.faceboxes,a.initialFaceboxes)||this.setState({faceboxes:a.initialFaceboxes,activeFacebox:null})};a.prototype.componentDidMount=function(){"use strict";this.refs.tokenizer.initWithoutFocus()};a.prototype.componentWillUnmount=function(){"use strict";this.refs.tokenizer.cleanup()};a.prototype.componentDidUpdate=function(){"use strict";if(this.needFocus){this.needFocus=!1;var a=this.state.activeFacebox,b=[];a.ignoreRecognition||(b=a.recognitions.map(function(a){return a.user.fbid}));this.refs.tokenizer.focusAndUpdateSuggestionsIDs(b)}};a.prototype.render=function(){"use strict";__p&&__p();var a=n.Children.only(this.props.children),b=[],c=[];if(!this.props.imageIsLoading){var d=this.state.faceboxes;for(var e in d){var f=d[e];f.tagUserID?c.push(this.$5(f)):b.push(this.$6(f))}Array.prototype.push.apply(c,Object.keys(this.state.tagsWithoutFaceboxes).map(function(a){return this.$5(this.state.tagsWithoutFaceboxes[a])}.bind(this)))}return n.createElement(h,{onMeasure:this.updateClientRect},n.createElement("div",{className:"_1k3"},n.createElement("div",{onClick:this.handleImageClick,role:"presentation"},a),b,c,this.$4()))};a.propTypes={initialFaceboxes:b.object,initialTags:b.object,onTagAdd:b.func,onTagDelete:b.func,typeaheadConfig:b.object.isRequired,typeaheadSuggestions:b.array,freeformTagging:b.bool.isRequired,imageIsLoading:b.bool};e.exports=a}),null);
__d("PhotoRendererProjection",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({PERSPECTIVE:"perspective",STEREOGRAPHIC:"stereographic",CYLINDRICAL:"cylindrical",EQUIRECTANGULAR:"equirectangular"})}),null);
__d("XPhotosEditPhotoController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/photos/edit/{id}/",{id:{type:"FBID",required:!0},notice_id:{type:"Int"},delete_cancelled:{type:"Exists",defaultValue:!1}})}),null);
__d("MSnowflakePhotoCard.react",["FullBleedFeedQE","Image.react","MSnowflakePhotoCardTagger.react","MSnowflakeTextWithEntities.react","MSnowflakeUFI.react","MXUICard.react","MXUIDiv.react","PhotoRendererProjection","React","SnowflakeWebDriverIDs","URI","XPhotosEditPhotoController","cx","emptyFunction","invariant","joinClasses"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){"use strict";__p&&__p();var w;b=o.PropTypes;c=babelHelpers.inherits(a,o.Component);w=c&&c.prototype;function a(){__p&&__p();var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=w.constructor).call.apply(a,[this].concat(d)),this.state={taggingMode:this.props.initialTaggingMode},this.toggleTaggingMode=function(){this.setState({taggingMode:!this.state.taggingMode})}.bind(this),this.deactivateTaggingMode=function(){this.setState({taggingMode:!1})}.bind(this),this.renderBody=function(){var a=[this.renderMessage(),this.renderUFI()].filter(function(a){return!!a});if(!a.length)return null;var b="_2hao _55x2";return o.createElement(m,{className:b},a)}.bind(this),this.canCreateTags=function(){return this.props.canCreateTags}.bind(this),this.canDeleteTags=function(){return this.props.canDeleteTags&&this.hasTags()}.bind(this),this.hasTags=function(){return this.refs.photoCardTagger.hasTags()}.bind(this),this.canActivateTaggingMode=function(){return(this.canCreateTags()||this.canDeleteTags())&&!this.state.taggingMode}.bind(this),this.renderImage=function(){return!this.state.taggingMode?this.renderBasicImage():o.createElement(i,{ref:"photoCardTagger",initialFaceboxes:this.props.initialFaceboxes,initialTags:this.props.initialTags,freeformTagging:this.props.freeformTagging,onTagAdd:this.props.onTagAdd,onTagDelete:this.props.onTagDelete,typeaheadConfig:this.props.typeaheadConfig,typeaheadSuggestions:this.props.typeaheadSuggestions},this.renderBasicImage())}.bind(this),b}a.prototype.UNSAFE_componentWillUpdate=function(a,b){!b.taggingMode||a.canCreateTags||u(0),!this.state.taggingMode&&b.taggingMode&&this.props.onActivateTagging(this)};a.prototype.renderMessage=function(){return!this.props.message||!this.props.message.text?null:o.createElement(m,{className:"_26p9",key:"message"},o.createElement(j,{text:this.props.message}))};a.prototype.getEditURL=function(){return!this.props.canEdit||!this.props.photoID?null:r.getURIBuilder().setFBID("id",this.props.photoID).getURI().toString()};a.prototype.getDeleteURL=function(){return!this.props.canDelete||!this.props.photoID?null:new q("/photo.php").addQueryData("fbid",this.props.photoID).addQueryData("delete",!0).toString()};a.prototype.renderUFI=function(){return!this.props.ufi?null:o.createElement(k,{ufi:this.props.ufi,editURL:this.getEditURL(),deleteURL:this.getDeleteURL(),isTaggingMode:this.state.taggingMode,initialIsCollapsed:this.props.initialIsUFICollapsed,imageSizeReductionFactor:this.props.imageSizeReductionFactor,canReport:this.props.canReport,canCreateTags:this.canCreateTags(),onToggleTagging:this.toggleTaggingMode,feedbackData:this.props.feedbackData,feedbackTarget:this.props.feedbackTarget,feedbackUpdatingParams:{isPhoto:!0,isPlayable:this.props.isPlayable,targetKey:this.props.feedbackTarget},key:"ufi"})};a.prototype.renderBasicImage=function(){__p&&__p();if(!this.props.imageSrc)return o.createElement("div",null);var a={};this.props.imageWidth&&(a.width=this.props.imageWidth*this.props.imageSizeReductionFactor);this.props.imageHeight&&(a.height=this.props.imageHeight*this.props.imageSizeReductionFactor);if(this.props.isPlayable&&this.props.playableURL)return o.createElement("video",{className:"_1_uo",style:a,src:this.props.playableURL,poster:this.props.imageSrc,controls:!0});var b=this.props.sphericalRendererProjectionType===n.PERSPECTIVE,c=this.props.imageSizeReductionFactor*100;c={width:c+"%",height:c+"%"};return o.createElement("div",{className:"_i81",style:c},o.createElement(h,{alt:this.props.accessibilityCaption,className:"_1_uo",style:a,src:this.props.imageSrc}),this.props.isSpherical?o.createElement("span",{className:b?"_4j4y":""}):null)};a.prototype.render=function(){var a=v(this.props.className,"_26pa"+(this.state.taggingMode?" _i82":"")+" _55x2");return o.createElement(l,{background:g.fullBleed?"white":null,className:a,"data-index":this.props.index,"data-testid":p.PHOTO_CARD},this.renderImage(),this.renderBody())};a.propTypes={accessibilityCaption:b.string,message:b.object,imageSrc:b.string,photoID:b.string,canEdit:b.bool,canDelete:b.bool,imageHeight:b.number,imageWidth:b.number,canCreateTags:b.bool,ufi:b.instanceOf(HTMLElement),feedbackTarget:b.string,isPreviewMode:b.bool,initialFaceboxes:b.object,initialTags:b.object,initialTaggingMode:b.bool,onTagAdd:b.func,onTagDelete:b.func,onActivateTagging:b.func,typeaheadConfig:b.object,initialIsUFICollapsed:b.bool,typeaheadSuggestions:b.array,isSpherical:b.bool,sphericalRendererProjectionType:b.string,isPlayable:b.bool,playableURL:b.string,playableURLHD:b.string};a.defaultProps={canEdit:!1,canDelete:!1,canCreateTags:!1,canDeleteTags:!1,initialTaggingMode:!1,onActivateTagging:t,freeformTagging:!0};e.exports=a}),null);
__d("PhotosContentViewingSurfaces",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({SNOWFLAKE:"snowflake",FULL_SCREEN_GALLERY:"full_screen_gallery",PERMALINK:"permalink",TAB_VIEW:"tab_view"})}),null);
__d("MSnowflakePhotoImpressionLogger",["BanzaiLogger","PhotosContentViewingSurfaces"],(function(a,b,c,d,e,f,g,h){a={logPhotoViewed:function(a){a.referrer=a.referrer||{},g.log("PhotoImpressionsLoggerConfig",{action:a.actionType,action_direction:a.actionDirection,logtype:a.logType,content_id:a.photo.id,owner_id:a.photo.owner.id,referrer:a.referrer.referrer,referrer_id:a.referrer.referrer_id,referrer_type:a.referrer.referrer_type,viewing_surface:h.SNOWFLAKE})}};e.exports=a}),null);
__d("MSnowflakeStoryHeaderCard.react",["FullBleedFeedQE","Image.react","MEntityLink.react","MSnowflakeHeaderMetaData.react","MSnowflakeTextWithEntities.react","MSnowflakeUFI.react","MTimestamp.react","MXUICard.react","MXUIDiv.react","React","SnowflakeWebDriverIDs","areEqual","cx"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){__p&&__p();var t;b=p.PropTypes;c=b.object;d=babelHelpers.inherits(a,p.Component);t=d&&d.prototype;function a(){__p&&__p();var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=t.constructor).call.apply(a,[this].concat(d)),this.renderMessage=function(){return!this.props.message?null:p.createElement(o,{className:"_26p9"},p.createElement(k,{text:this.props.message}))}.bind(this),this.renderMetaData=function(){return p.createElement(j,{mediaCount:this.props.mediaCount})}.bind(this),this.renderUFI=function(){return!this.props.ufi?null:p.createElement(l,{isAlbum:this.props.isAlbumStory,editURL:this.props.editURL,ufi:this.props.ufi,feedbackTarget:this.props.feedbackTarget,isShareable:this.props.isShareable,feedbackData:this.props.feedback,initialIsCollapsed:this.props.initialIsUFICollapsed,feedbackUpdatingParams:{isPhotoSetStory:!0,targetKey:this.props.setToken}})}.bind(this),this.renderStoryHeader=function(){return p.createElement(o,{className:"_3v9e"},this.renderProfilePic(),p.createElement(o,{className:"_3v9f"},this.renderStoryTitle(),this.renderStoryMetaData()))}.bind(this),this.renderTimestamp=function(){return p.createElement(m,{timestamp:this.props.creationTime})}.bind(this),this.renderPrivacyScope=function(){return!this.props.privacyScope?null:p.createElement(h,{className:"_3v9g",src:this.props.privacyScope.icon_image.uri,alt:this.props.privacyScope.label})}.bind(this),this.renderStoryMetaData=function(){return p.createElement(o,{className:"_3v9h"},this.renderTimestamp(),this.renderPrivacyScope())}.bind(this),this.renderStoryTitle=function(){var a=this.props.title;return!a?this.renderMainActor():p.createElement(o,null,p.createElement(k,{text:a}))}.bind(this),this.renderMainActor=function(){var a=this.getMainActor();return p.createElement(o,{className:"_3kz9"},p.createElement(i,{entity:a},a.name))}.bind(this),this.getMainActor=function(){var a=this.props.actors;return a&&a[0]||{}}.bind(this),this.renderProfilePic=function(){var a=this.getMainActor().profile_picture;return!a?null:p.createElement(h,{className:"_3v9i",src:a.uri})}.bind(this),b}a.prototype.shouldComponentUpdate=function(a){"use strict";return!r(this.props,a)};a.prototype.render=function(){"use strict";return g.fullBleed?p.createElement(o,{className:"_189t"},p.createElement(o,{background:"white",className:"_55x2 _4zvh","data-testid":q.HEADER_CARD},p.createElement(o,{className:"_tmc"},this.renderStoryHeader(),this.renderMessage(),this.renderMetaData()),this.renderUFI())):p.createElement(o,{className:"_189t"},p.createElement(n,{className:"_4zvh","data-testid":q.HEADER_CARD},p.createElement(o,{className:"_tmc"},this.renderStoryHeader(),this.renderMessage(),this.renderMetaData()),this.renderUFI()))};a.propTypes={actors:b.array,creationTime:b.number,isAlbumStory:b.bool,editURL:b.string,feedback:b.object,initialIsUFICollapsed:b.bool,isShareable:b.bool,message:c,modifiedTime:b.number,mediaCount:b.number,privacyScope:b.object,setToken:b.string.isRequired,title:c,ufi:b.instanceOf(HTMLElement)};e.exports=a}),null);
__d("ScrollablePhotoViewStateCore",["SubscriptionsHandler","emptyFunction"],(function(a,b,c,d,e,f,g,h){__p&&__p();function a(a){"use strict";this.$1=a.photoStore,this.$2=a.viewer,this.$3=a.setToken,this.$4=a.updateCallback,this.$5=a.subscribeUpdatePhotos,this.$6=a.fetchInitData,this.$7=a.initBatchSize,this.$8=a.pageBatchSize,this.$9=new g()}a.prototype.initViewState=function(){"use strict";this.$9.addSubscriptions(this.$5(this.updateData.bind(this)));if(this.$1.hasBeenCreated(this.$3)){var a=this.$1.getAvailableRange(this.$3).length;(a>=this.$7||!this.$1.hasNextPage(this.$3))&&this.syncState();return}this.$6(this.$3)};a.prototype.hasNextPage=function(){"use strict";return this.$1.hasBeenCreated(this.$3)&&this.$1.hasNextPage(this.$3)};a.prototype.fetchToIndex=function(a){"use strict";var b=this.$1.getEndIndex(this.$3);a=a-b;if(a<=0)return;this.$1.getItemsAfterIndex(this.$3,b,a,h)};a.prototype.fetchMore=function(a){"use strict";if(!this.hasNextPage())return;this.$1.getItemsAfterIndex(this.$3,this.$1.getEndIndex(this.$3),this.$8,a||h)};a.prototype.destroy=function(){"use strict";this.$9.release()};a.prototype.updateData=function(a){"use strict";if(a.set_id!=this.$3)return;a=a.query_results&&a.query_results.result_type;a=="init"?this.$1.executePostCreate(this.$3,function(){this.syncState()}.bind(this)):this.syncState()};e.exports=a}),null);
__d("MSnowflakeStoryViewState",["MLinkTracking","MPhotoSetStore","MPhotoStore","MRequest","MSnowflakeJSConstants","ScrollablePhotoViewStateCore","Stratcom","warning"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){__p&&__p();var o;function p(a){return m.listen("m:photostore:afterupdate",null,function(event){a(event.getData())})}function q(a){var b=a.storyIdentifier,c=a.trackingData;a=a.permalink;var d={};b&&(d.ei=b);a&&(d.permalink=a);return function(a){a=new j(k.INIT_PATH).setData(babelHelpers["extends"]({},d,{set:a}));c&&g.addFeedTrackingDataToRequest(a,c);return a.send()}}a=babelHelpers.inherits(r,l);o=a&&a.prototype;function r(a){var b=a.setToken,c=a.storyIdentifier,d=a.permalink,e=a.trackingData;a=a.updateCallback;o.constructor.call(this,{photoStore:i,setToken:b,updateCallback:a,subscribeUpdatePhotos:p,fetchInitData:q({storyIdentifier:c,trackingData:e,permalink:d}),initBatchSize:k.VIEWER_INIT_BATCH_SIZE,pageBatchSize:k.VIEWER_PAGE_BATCH_SIZE});this.$MSnowflakeStoryViewState1=!1;this.$MSnowflakeStoryViewState2=a;this.$MSnowflakeStoryViewState3=b}r.prototype.destroy=function(){"use strict";o.destroy.call(this),this.$MSnowflakeStoryViewState1=!0,this.$MSnowflakeStoryViewState2=null};r.prototype.syncState=function(){"use strict";if(this.$MSnowflakeStoryViewState1){n(!1,"MSnowflakeStoryViewState.syncState(): Must not call `syncState()` after having called `destroy()` on this instance of `MSnowflakeStoryViewState` with set token `%s`.",this.$MSnowflakeStoryViewState3);return}h.getBySetToken(this.$MSnowflakeStoryViewState3,function(a){return this.$MSnowflakeStoryViewState2({photoSet:a})}.bind(this));var a=i.getItemsInAvailableRange(this.$MSnowflakeStoryViewState3);this.$MSnowflakeStoryViewState2({media:a,hasNextPage:i.hasNextPage(this.$MSnowflakeStoryViewState3)})};r.syncAllPhotoViewStates=function(){"use strict";var a=h.getLoadedPhotoSetTokens();a.forEach(function(a){m.invoke("m:photostore:afterupdate",null,{set_id:a})})};m.listen("m:snowflakeviewstates:sync",null,function(){return r.syncAllPhotoViewStates()});e.exports=r}),null);
__d("PhotosLogType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({NAVIGATION:"navigation",VPV:"vpv",TIMETRACKING:"timetracking"})}),null);
__d("MSnowflakeViewportTracking",["FBFeedLocations","MViewport","MViewportTracking","PhotosLogType","ReactDOM","Vector","csx","emptyFunction"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";__p&&__p();var o;o=babelHelpers.inherits(a,i);o&&o.prototype;a.prototype.getDataFromConfig=function(a){this.isTimeTrackingEnabled=!!a.vpvd_logging,this.$MSnowflakeViewportTracking1=a.snowflakeComponent,this.$MSnowflakeViewportTracking2=a.recordDelay,this.$MSnowflakeViewportTracking3=a.loggingFunction||n};a.prototype.getFBFeedLocation=function(){return g.PERMALINK};a.prototype.getAllStories=function(){if(this.$MSnowflakeViewportTracking1.isMounted()){var a=k.findDOMNode(this.$MSnowflakeViewportTracking1).querySelectorAll("._26pa");return a}return[]};a.prototype.getTimeout=function(){return this.$MSnowflakeViewportTracking2};a.prototype.getStoryID=function(a){return a.getAttribute("data-index")};a.prototype.getDataToLog=function(a){return{logtype:j.VPV,index:this.getStoryID(a),tracking:{story_height:l.getElementDimensions(a).y,viewport_height:h.getHeight()}}};a.prototype.getMinSizeToBeVisible=function(a){a=a.querySelector("._1_uo");a=l.getElementDimensions(a).y;return a*.5};a.prototype.sendDataToLog=function(a){this.$MSnowflakeViewportTracking3(a)};function a(){o.apply(this,arguments)}e.exports=a}),null);
__d("PhotosUserActionTypes",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({SWIPE:"swipe",SCROLL:"scroll",CLICK:"click",KEYS:"keys"})}),null);
__d("MSnowflake.react",["DOM","FullBleedFeedQE","MeasuredComponent.react","MLinkTracking","MLoadingSpinner.react","MRequest","MSnowflakeAlbumHeaderCard.react","MSnowflakePagerCard.react","MSnowflakePhotoCard.react","MSnowflakePhotoImpressionLogger","MSnowflakeSettings","MSnowflakeStoryHeaderCard.react","MSnowflakeStoryViewState","MSnowflakeViewportTracking","MXUIDiv.react","PhotosLogType","PhotosUserActionTypes","React","ReactDOM","SnowflakeWebDriverIDs","URI","cx","emptyFunction","fbt","getActorFirstName","requestAnimationFrame"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F){__p&&__p();a=x.PropTypes;b=x.createClass({displayName:"ReactSnowflake",_isMounted:!1,propTypes:{setToken:a.string.isRequired,storyIdentifier:a.string,media:a.object,photoSet:a.object,referrer:a.object,isPermalink:a.bool,scrollTargetIndex:a.number,scrollToPhoto:a.string,followButton:a.instanceOf(HTMLElement),coverPhotoSrc:a.string,showNewPermalink:a.bool,showAlbumFeed:a.bool,onPhotoSetDataAvailable:a.func},getDefaultProps:function(){return{onPhotoSetDataAvailable:C}},getInitialState:function(){return{didRequestPhoto:!1,didScroll:!1,media:this.props.media||[]}},componentDidMount:function(){this._isMounted=!0,this.viewState=new s({setToken:this.props.setToken,storyIdentifier:this.props.storyIdentifier,trackingData:j.getFeedTrackingData(y.findDOMNode(this)),permalink:this.props.isPermalink,updateCallback:this._onViewStateChange}),F(function(){if(!this._isMounted)return;this.viewState.initViewState();q.VPV_LOGGING_GK&&(this.viewportTracking=new t(),this.viewportTracking.init({loggingFunction:function(a){return p.logPhotoViewed({actionType:w.SCROLL,photo:this.state.media[a.index],logType:a.logtype,tracking:a.tracking,referrer:this.props.referrer})}.bind(this),recordDelay:1e3,snowflakeComponent:this,vpvd_logging:q.vpvd_logging}))}.bind(this)),this.setupFeedtracking()},setupFeedtracking:function(){this.feedtrackingListener=g.listen(y.findDOMNode(this),"touchstart","tag:a",function(a){a=a.getNode("tag:a");a&&j.addFeedTrackingDataToHref(a)})},componentWillUnmount:function(){this._isMounted=!1,this.viewState.destroy(),delete this.viewState,this.viewportTracking&&this.viewportTracking.cleanup(),this.feedtrackingListener.remove()},_onViewStateChange:function(a){this._isMounted&&this.setState(a)},_requestTargetPhotoData:function(){var a=this.props.scrollTargetIndex;a!=null&&this.viewState.fetchToIndex(a);this.setState({didRequestPhoto:!0})},scrollToTargetPhoto:function(){var a=!1;this.refs.scrollTarget&&(this.setState({didScroll:!0}),y.findDOMNode(this.refs.scrollTarget).scrollIntoView(!0),a=!0);Object.prototype.hasOwnProperty.call(this,"scrollTargetIndex")&&p.logPhotoViewed({photo:this.state.media[this.scrollTargetIndex],actionType:w.CLICK,logType:v.NAVIGATION,referrer:this.props.referrer});return a},switchCurrentTaggingModeCard:function(a){var b=this.state.currentTaggingModeCard;b&&b!==a&&b.deactivateTaggingMode();this.setState({currentTaggingModeCard:a})},buildTagURI:function(a,b,c,d){return new A("/a/photos/tag/").addQueryData({photo_fbid:a,"ids[0]":b,"x[0]":c,"y[0]":d,is_snowflake:!0,sd_source:this.props.source,sd_set:this.props.setToken})},buildDeleteTagURI:function(a){return new A("/a/photo/").addQueryData({fbid:a,snowflake_tag_remove:!0})},sendTagRequest:function(a,b){new l(this.buildTagURI(a,b.tagUserID,b.x,b.y).toString()).send()},sendDeleteTagRequest:function(a,b){new l(this.buildDeleteTagURI(a).toString()).setData({rtid:b.tagUserID}).send()},canRenderPhotos:function(){return this.state.media.length&&this.state.photoSet},renderPhotos:function(){if(!this.canRenderPhotos())return x.createElement(u,{padding:"large",textalign:"center"},x.createElement(k,null));var a=20;h.fullBleed&&(a=0);return this.state.media.map(function(b,c){var d=this.props.scrollToPhoto===b.id;d&&(this.scrollTargetIndex=c);var e=this.props.wemImageSizeReductionFactor?this.props.wemImageSizeReductionFactor:1;return x.createElement(o,{accessibilityCaption:b.accessibility_caption,key:"photo_"+b.id,index:c,ref:d?"scrollTarget":null,imageSrc:b.image.uri,photoID:b.id,canEdit:b.can_viewer_edit,canDelete:b.can_viewer_delete,message:b.message,imageWidth:this.state.viewportWidth-a,imageHeight:(this.state.viewportWidth-a)/b.ratio,imageSizeReductionFactor:e,feedbackData:b.feedback,feedbackTarget:b.id.toString(),canReport:b.can_viewer_report,canCreateTags:b.can_viewer_add_tags,canDeleteTags:b.can_viewer_untag,onActivateTagging:this.switchCurrentTaggingModeCard,typeaheadConfig:this.state.photoSet.taggingTypeaheadConfig,typeaheadSuggestions:this.state.photoSet.taggingTypeaheadSuggestions,initialFaceboxes:b.faceboxes,initialIsUFICollapsed:!1,onTagAdd:this.sendTagRequest.bind(this,b.id),onTagDelete:this.sendDeleteTagRequest.bind(this,b.id),initialTags:b.tags,ufi:b.ufi,isSpherical:b.is_spherical,sphericalRendererProjectionType:b.spherical_renderer_projection_type,isPlayable:b.is_playable,playableURL:b.playable_url,playableURLHD:b.playable_url_hd})}.bind(this))},getTitle:function(){if(this.state.photoSet){if(!this.getOwner()&&this.state.photoSet.title)return this.state.photoSet.title;if(this.isAlbum())return D._("{name}'s Album",[D._param("name",this.getOwnerName())]);else return D._("{name}'s post",[D._param("name",this.getOwnerName())])}},componentDidUpdate:function(a,b){if(!this.state.didScroll&&this.canRenderPhotos()){a=this.scrollToTargetPhoto();!a&&!this.state.didRequestPhoto&&this._requestTargetPhotoData()}this.state.photoSet!=b.photoSet&&this.props.onPhotoSetDataAvailable()},isAlbum:function(){return this.state.photoSet&&this.state.photoSet.titleCardStyle==="album"},getOwner:function(){if(this.state.photoSet.contributors)return this.state.photoSet.contributors[0];return this.state.photoSet.story?this.state.photoSet.story.actors[0]:null},getOwnerName:function(){var a=this.getOwner()||{name:D._("Unknown")},b=a.structured_name;if(b)return E(b);else return a.name},isHeaderUFICollapsed:function(){return!1},renderHeader:function(){__p&&__p();if(!this.state.photoSet)return null;var a=this.state.photoSet.message;!a&&this.state.photoSet.story&&(a=this.state.photoSet.story.message);if(this.isAlbum()){var b=this.state.photoSet.story&&this.state.photoSet.story.privacy_scope,c=this.state.photoSet.feedbackTarget&&this.state.photoSet.feedbackTarget.toString();return x.createElement(m,{title:this.state.photoSet.title,contributors:this.state.photoSet.contributors,owner:this.state.photoSet.owner,modifiedTime:this.state.photoSet.modifiedTime,mediaCount:this.state.photoSet.mediaCount,message:a,privacyScope:b,feedback:this.state.photoSet.feedback,feedbackTarget:c,initialIsUFICollapsed:this.isHeaderUFICollapsed(),ufi:this.state.photoSet.ufi,followButton:this.props.followButton,coverPhotoSrc:this.props.coverPhotoSrc,showNewPermalink:this.props.showNewPermalink})}else if(this.state.photoSet.story){b=this.state.photoSet.story;return x.createElement(r,{title:b.title,actors:b.actors,isAlbumStory:this.state.photoSet.editURL!=null,editURL:this.state.photoSet.editURL,modifiedTime:this.state.photoSet.modifiedTime,mediaCount:this.state.photoSet.mediaCount,isShareable:!!b.shareable,creationTime:b.creation_time,privacyScope:b.privacy_scope,message:a,feedback:this.state.photoSet.feedback||b.feedback,feedbackTarget:c,setToken:this.props.setToken,ufi:this.state.photoSet.ufi,initialIsUFICollapsed:this.isHeaderUFICollapsed()})}return null},renderPager:function(){return!this.state.hasNextPage?null:x.createElement(n,{onFetchMore:function(){return this.viewState.fetchMore()}.bind(this)})},onClientMeasured:function(a){this._isMounted&&this.setState({viewportWidth:a.width})},getFeedtrackingOwnerID:function(){return this.props.feedtrackingID},render:function(){var a=["context-layer-root","dialog-ignore-subtree-links","snowflake-root"].join(" "),b=this.renderHeader();this.props.showAlbumFeed||(b=x.createElement(u,null,this.renderHeader(),this.renderPhotos(),this.renderPager()));return x.createElement(i,{onMeasure:this.onClientMeasured},x.createElement("div",{"data-ownerid":this.getFeedtrackingOwnerID(),"data-sigil":a,"data-testid":z.ROOT,className:"_4vuj"+(h.fullBleed?" _gjp":"")},b))}});e.exports=b}),null);
__d("MSnowflakeModalDialog",["MModalDialog","MSnowflake.react","React","ReactDOM","ScriptPath","Stratcom","SubscriptionsHandler"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m){__p&&__p();var n=null,o=new m();e.exports={bootstrap:function(a,b){__p&&__p();a.onPhotoSetDataAvailable=function(){g.setTitle(n.getTitle())};if(!n){var c=k.getPageInfo()||{};k.set("snowflake","");o.engage();o.addSubscriptions(l.listen("m:modal-dialog:will-close",null,function(){o.release(),j.unmountComponentAtNode(j.findDOMNode(n).parentNode),n=null,k.set(c.scriptPath,"",c.extraData)}))}else a.scrollToPhoto=null;n=j.render(i.createElement(h,a),b)}}}),null);
__d("GraphQLQuery_DEPRECATED",["createObjectFrom"],(function(a,b,c,d,e,f,g){__p&&__p();var h;i.prototype.addField=function(a){"use strict";this.fieldSet?this.fieldSet.fields.push(a):this.fieldSet=new j.FieldSet([a])};i.prototype.addFields=function(a){"use strict";a.forEach(this.addField,this)};function i(){"use strict"}a=babelHelpers.inherits(j,i);h=a&&a.prototype;function j(a,b){"use strict";h.constructor.call(this),this.rootCall=a,this.fieldSet=b}j.prototype.toString=function(){"use strict";return(this.rootCall||"")+(this.fieldSet||"")};j.Call=function(){function a(a,b){"use strict";this.name=a,this.args=b||[]}a.prototype.toString=function(){"use strict";return this.name+"("+this.args.join(",")+")"};return a}();j.CallValue=function(){function a(a){"use strict";this.callValue=a}a.prototype.toString=function(){"use strict";return this.callValue.replace(/[)(}{><,.\\]/g,"\\$&")};return a}();j.CallVariable=function(){function a(a){"use strict";this.callVariableName=a}a.prototype.toString=function(){"use strict";return"<"+this.callVariableName+">"};return a}();j.Field=function(){__p&&__p();var a,b;a=babelHelpers.inherits(c,i);b=a&&a.prototype;function c(c,d,e,g,h,a){"use strict";b.constructor.call(this),this.name=g||c,this.fieldName=c,this.calls=d||[],this.fieldSet=e,this.alias=g,this.condition=h,this.exports=a||[]}c.prototype.toString=function(){"use strict";var a="";this.condition&&(a+=this.condition+"?");a+=this.fieldName;this.calls.length!==0&&(a+="."+this.calls.join("."));this.alias&&(a+=" as "+this.alias);this.exports.length!==0&&(a+=" exports ",a+=this.exports.length===1?this.exports[0]:"("+this.exports.join(",")+")");this.fieldSet&&(a+=this.fieldSet);return a};c.prototype.addCall=function(a){"use strict";this.calls.push(a)};c.prototype.removeCalls=function(a){"use strict";a=g(a);var b=[];for(var c=0;c<this.calls.length;c++)a[this.calls[c].name]||b.push(this.calls[c]);this.calls=b};return c}();j.FieldSet=function(){__p&&__p();function a(a){"use strict";this.fields=a||[]}a.prototype.getFields=function(){"use strict";var a=[];for(var b=0;b<this.fields.length;b++)this.fields[b]instanceof j.Field&&a.push(this.fields[b]);return a};a.prototype.getFragmentReferences=function(){"use strict";var a=[];for(var b=0;b<this.fields.length;b++)this.fields[b]instanceof j.FragmentReference&&a.push(this.fields[b]);return a};a.prototype.toString=function(){"use strict";return"{"+this.fields.join(",")+"}"};return a}();j.FragmentReference=function(){__p&&__p();function a(b,c,a){"use strict";this.name=b,this.is_conditional=c,this.exports=a||[]}a.prototype.toString=function(){"use strict";var a="@"+this.name;this.is_conditional&&(a="?"+a);this.exports.length!==0&&(a+=" exports ",a+=this.exports.length===1?this.exports[0]:"("+this.exports.join(",")+")");return a};return a}();e.exports=j}),null);
__d("GraphQLParser_DEPRECATED",["GraphQLQuery_DEPRECATED"],(function(a,b,c,d,e,f,g){__p&&__p();function h(a){"use strict";this.queryString=a,this.queryLength=a.length,this.index=-1,this.character=null,this.next()}h.prototype.error=function(a){"use strict";throw new h.SyntaxError(this.queryString,this.index,a)};h.prototype.next=function(a){"use strict";a&&a!==this.character&&this.error('Expected "'+a+'" instead of "'+this.character+'".'),this.index++,this.index>this.queryLength?this.error("Expected another character, but at end of string."):this.character=this.index===this.queryLength?null:this.queryString[this.index]};h.prototype.end=function(){"use strict";this.character&&this.error("Expected end of string instead of "+this.character+".")};h.prototype.whitespace=function(){"use strict";while(this.character===" "||this.character==="\t"||this.character==="\r"||this.character==="\n")this.next()};h.prototype.mandatoryWhitespace=function(){"use strict";var a=this.index;this.whitespace();this.index===a&&this.error("Expected whitespace, got "+this.character+".")};h.prototype.keyword=function(a){"use strict";for(var b=0;b<a.length;b++)this.next(a[b])};h.prototype.query=function(a){"use strict";var b=null;a&&(b=new g.Call(this.name(),this.callArguments()),this.whitespace());a=null;this.character==="{"&&(a=this.fieldSet());return new g(b,a)};h.prototype.name=function(){"use strict";var a=this.index;this.character===":"&&this.error("Name cannot begin with :");while(j(this.character))this.next();this.index===a&&this.error("Expected name.");return this.queryString.substr(a,this.index-a)};h.prototype.fieldSet=function(){"use strict";__p&&__p();var a=[];this.next("{");this.whitespace();a.push(this.field());this.whitespace();while(this.character===",")this.next(","),this.whitespace(),a.push(this.field()),this.whitespace();this.next("}");return new g.FieldSet(a)};h.prototype.exports=function(){"use strict";__p&&__p();var a;if(this.character==="("){this.next("(");while(!0){this.whitespace();a=a||[];a.push(this.name());if(this.character===",")this.next(",");else break}this.whitespace();this.next(")")}else a=[this.name()];return a};h.prototype.field=function(){"use strict";__p&&__p();var a;if(this.character==="@"||this.character==="?"){var b=!1;this.character==="?"&&(this.next("?"),b=!0);this.next("@");var c=this.name();this.whitespace();this.character==="e"&&(this.keyword("exports"),this.mandatoryWhitespace(),a=this.exports());return new g.FragmentReference(c,b,a)}var d;c=this.name();this.whitespace();this.character==="?"?(this.next("?"),this.whitespace(),b=this.name(),d=c):b=c;this.whitespace();c=this.calls();var e;this.character==="a"&&(this.next("a"),this.next("s"),this.whitespace(),e=this.name(),this.whitespace());this.character==="e"&&(this.keyword("exports"),this.mandatoryWhitespace(),a=[this.name()],this.whitespace());this.whitespace();var h;this.character==="{"&&(h=this.fieldSet());return new g.Field(b,c,h,e,d,a)};h.prototype.calls=function(){"use strict";var a=[];while(this.character===".")this.next("."),this.whitespace(),a.push(new g.Call(this.name(),this.callArguments())),this.whitespace();return a};h.prototype.callArguments=function(){"use strict";__p&&__p();this.next("(");this.whitespace();var a=[];if(this.character!==")"){a.push(this.callArgument());while(this.character===",")this.next(","),this.whitespace(),a.push(this.callArgument())}this.next(")");return a};h.prototype.callArgument=function(){"use strict";return this.character==="<"?this.callVariable():this.callValue()};h.prototype.callVariable=function(){"use strict";this.next("<");var a=this.name();this.next(">");return new g.CallVariable(a)};h.prototype.callValue=function(){"use strict";__p&&__p();var a=this.index,b=!1;while(k(this.character))this.character==="\\"&&(this.next(),b=!0),this.next();this.index===a&&this.error("Expected call value.");var c=this.index-a;a=this.queryString.substr(a,c);a=a.replace(/\s+$/,"");if(b)for(var b=0;b<c;++b)a[b]==="\\"&&(a=a.substr(0,b)+a.substr(b+1),--c);return new g.CallValue(a)};h.SyntaxError=function(){__p&&__p();var a,b;a=babelHelpers.inherits(c,Error);b=a&&a.prototype;function c(a,c,d){"use strict";var e='Syntax error "'+d+'" at character '+c+' near "'+i(a,c)+'" in query: '+a;b.constructor.call(this,e);this.queryString=a;this.character=c;this.parserError=d;this.message=e}return c}();function i(a,b){return a.substr(0,b+1).replace(/\s+/g," ").substr(-10)+"\u20dd"+a.substr(b+1).replace(/\s+/g," ").substr(0,10)}function j(a){return a===null?!1:a==="_"||a===":"||a==="-"||a>="0"&&a<="9"||a>="A"&&a<="Z"||a>="a"&&a<="z"}function k(a){return a===null?!1:a!="("&&a!=")"&&a!="{"&&a!="}"&&a!="<"&&a!=">"&&a!="."&&a!=","}h.parseQuery=function(a){a=new h(a);a.whitespace();var b=a.query(!0);a.whitespace();a.end();return b};h.parseRootlessQuery=function(a){a=new h(a);a.whitespace();var b=a.query(!1);a.whitespace();a.end();return b};e.exports=h}),null);
__d("firstx",["invariant"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function a(a){__p&&__p();for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;return d}g(0)}e.exports=a}),null);
__d("PagedQuery",["GraphQLParser_DEPRECATED","GraphQLQuery_DEPRECATED","firstx","isEmpty"],(function(a,b,c,d,e,f,g,h,i,j){__p&&__p();function k(a,b){"use strict";this.$1=a,this.$2=b}k.prototype.$3=function(){"use strict";var a=this.findFieldByPath(this.$1);a.removeCalls(["find","after","before","first","last"]);return a};k.prototype.$4=function(a,b,c){"use strict";var d=this.$3(),e=c?"after":"before";d.addCall(new h.Call(e,[a]));e=c?"first":"last";d.addCall(new h.Call(e,[b]));return this.$1.toString()};k.prototype.$5=function(a){"use strict";a=this.$2[a];return typeof a==="object"&&!j(a)?i(Object.keys(a)):null};k.prototype.$6=function(a){"use strict";var b=this.$5(a);return b?b:this.$2[a]};k.prototype.$7=function(a){"use strict";var b=this.$5(a);return b?this.$2[a][b]:this.$2[a]};k.prototype.pageAfterQueryString=function(a,b){"use strict";return this.$4(a,b,!0)};k.prototype.pageBeforeQueryString=function(a,b){"use strict";return this.$4(a,b,!1)};k.prototype.pageFirstQueryString=function(a){"use strict";var b=this.$3();b.addCall(new h.Call("first",[a]));return this.$1.toString()};k.prototype.pageLastQueryString=function(a){"use strict";var b=this.$3();b.addCall(new h.Call("last",[a]));return this.$1.toString()};k.prototype.findFieldByPath=function(a){"use strict";__p&&__p();var b=a,c=this.$6(0);if(a.rootCall.name!=c)throw new Error("Query path does not match root query at top node, expected "+c+", found "+a.name+" instead.");for(var c=1;c<this.$2.length;c++){a=b.fieldSet.fields;var d=!1,e=this.$6(c);for(var f=0;f<a.length;f++)if(a[f].fieldName==e){b=a[f];d=!0;break}if(!d)throw new Error("Query path does not match query structure at location "+c+", expected "+e+", not located in "+a)}return b};k.prototype.findDataByPath=function(a){"use strict";a=a;for(var b=0;b<this.$2.length;b++){var c=this.$7(b);if(!a||!a[c])throw new Error("Query path does not match payload at location "+b+", expected "+c);a=a[c]}return a};k.constructFromPath=function(a,b){return new k(g.parseQuery(a),b)};e.exports=k}),null);
__d("PagedQueryCache",["GraphQLParser_DEPRECATED","KeyedCallbackManager","emptyFunction"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();function a(a,b,c,d){"use strict";__p&&__p();a=a.bind(this);this.$1=this.$1.bind(this,a);this.$2=b;this.$3=babelHelpers["extends"]({enableLooping:!1},d);a=this.$2.findDataByPath(c);b=a.edges;this.$4=babelHelpers["extends"]({},a.page_info,{start_cursor:b[0].cursor,end_cursor:b[b.length-1].cursor});this.$5=new h();this.$6={};this.$7={};this.$8={};this.$9=0;this.$10=0;this.$11={};this.$12(b,0);this.$3.allDataLoaded&&this.$13()}a.prototype.$1=function(a,b,c,d,e,f,h){"use strict";__p&&__p();var i=g.parseQuery(b);i=c.findFieldByPath(i);var j={};for(var k=0;k<i.calls.length;k++){var l=i.calls[k];l.args.length>0&&(j[l.name]=l.args[0].callValue)}Object.assign(j,f);a(b,c,d,e,j,h)};a.prototype.$12=function(a,b){"use strict";__p&&__p();var c={},d=!1;for(var e=0;e<a.length;e++){if(this.hasLooped())break;var f=b+e,g=a[e].cursor,h=a[e].node,i=this.$6[g];if(this.$3.enableLooping&&i!==undefined){d=!0;continue}i=this.$5.getResource(f);if(i!==undefined&&i!=g)throw new Error("Attempting to add cursor "+g+" at location "+f+" which already contains cursor "+i);this.$8[h.id]=g;this.$7[g]=h;c[f]=g;this.$6[g]=f;this.$9=Math.min(f,this.$9);this.$10=Math.max(f,this.$10)}d&&this.$13();this.$5.addResourcesAndExecute(c)};a.prototype.getItemsAfterCursor=function(a,b,c){"use strict";this.$14(a,b,!0,c)};a.prototype.getItemsBeforeCursor=function(a,b,c){"use strict";this.$14(a,b,!1,c)};a.prototype.$15=function(a){"use strict";if(!this.hasLooped())return a;var b=this.$16.end-this.$16.start+1;while(a<this.$16.start||a>this.$16.end)a<this.$16.start?a+=b:a-=b;return a};a.prototype.$14=function(a,b,c,d){"use strict";__p&&__p();var e=this.$17(a);c||(e=e-b-1);var f=[];for(var g=1;g<=b;g++)f.push(this.$15(e+g));g=this.$5.getUnavailableResourcesFromRequest(f);if(g.length){g=this.$18(g);if(!g.length)return;c?this.$3.enableLooping&&!this.hasNextPage(a)?e=this.$2.pageFirstQueryString(b):e=this.$2.pageAfterQueryString(a,b):this.$3.enableLooping&&!this.hasPreviousPage(a)?e=this.$2.pageLastQueryString(b):e=this.$2.pageBeforeQueryString(a,b);for(var a=0;a<g.length;++a)this.$11[g[a]]=!0;this.$19&&this.$19();this.$1(e,this.$2,g,c?this.$3.first_query:this.$3.last_query,this.$3.persistent_params,this.$20.bind(this))}var h=function(a){var c=[];for(var d=0;d<b;d++)c.push(this.$7[a[f[d]]]);return c}.bind(this);this.$5.executeOrEnqueue(f,function(a){d(h(a))})};a.prototype.$20=function(){"use strict";this.$21.apply(this,arguments)};a.prototype.$17=function(a){"use strict";a=this.$6[a];if(a===undefined)throw new Error("Cursor not found: the request can still be made but the result would not link to the existing data");return a};a.prototype.setPayloadCallback=function(a){"use strict";this.$21=a};a.prototype.updateData=function(a){"use strict";__p&&__p();a=this.$2.findDataByPath(a.query_results);a=a&&a.edges;if(!a)return;for(var b=0;b<a.length;++b){var c=a[b].cursor,d=a[b].node;this.$7[c]===undefined&&(this.$7[c]={});for(var e in d)this.$7[c][e]=d[e]}};a.prototype.addData=function(a){"use strict";__p&&__p();var b=!1,c=null,d=0;for(var e in a.query_params)(e=="after"||e=="before")&&(c=a.query_params[e]),(e=="first"||e=="last")&&(b=e=="first",d=a.query_params[e]);this.$3.enableLooping&&!c&&(c=b?this.$4.end_cursor:this.$4.start_cursor);if(!c||this.$6[c]===undefined)return;var f=this.$6[c],g=this.$2.findDataByPath(a.query_results);if(!g.edges.length){this.$22(a.requested_indices);b?(this.$4.has_next_page=!1,this.$3.enableLooping&&this.getItemsAfterCursor(c,d,i)):(this.$4.has_previous_page=!1,this.$3.enableLooping&&this.getItemsBeforeCursor(c,d,i));return}b?(c=f+1,this.$4.end_cursor=g.edges[g.edges.length-1].cursor,this.$4.has_next_page=g.page_info.has_next_page):(c=f-g.edges.length,this.$4.start_cursor=g.edges[0].cursor,this.$4.has_previous_page=g.page_info.has_previous_page);this.$12(g.edges,c);this.$22(a.requested_indices)};a.prototype.hasNextPage=function(a){"use strict";var b=this.$17(a);if(this.$5.getResource(b+1))return!0;else if(a==this.$4.end_cursor)return this.$4.has_next_page;else throw new Error("hasNextPage called on unknown cursor")};a.prototype.hasPreviousPage=function(a){"use strict";var b=this.$17(a);if(this.$5.getResource(b-1))return!0;else if(a==this.$4.start_cursor)return this.$4.has_previous_page;else throw new Error("hasPreviousPage called on unknown cursor")};a.prototype.hasLooped=function(){"use strict";return this.$3.enableLooping&&this.$16};a.prototype.getItemAtIndex=function(a,b){"use strict";a=this.$15(a),this.$5.executeOrEnqueue([a],function(c){b(this.$7[c[a]])}.bind(this))};a.prototype.getItemAtIndexImmediate=function(a){"use strict";a=this.$15(a);a=this.$5.getResource(a);var b;a&&(b=this.$7[a]);return b};a.prototype.getAvailableRange=function(){"use strict";var a=this.$17(this.$4.start_cursor),b=this.$17(this.$4.end_cursor);return{offset:a,length:b-a+1}};a.prototype.getCursorForID=function(a){"use strict";return this.$8[a]};a.prototype.getIndexForID=function(a){"use strict";a=this.getCursorForID(a);return a!==undefined?this.$6[a]:undefined};a.prototype.$22=function(a){"use strict";if(a)for(var b=0;b<a.length;++b)delete this.$11[a[b]]};a.prototype.$18=function(a){"use strict";if(!this.$11)return a;var b=[];for(var c=0;c<a.length;++c)this.$11[a[c]]||b.push(a[c]);return b};a.prototype.$13=function(){"use strict";this.$16={start:this.$9,end:this.$10}};a.prototype.setPreFetchCallback=function(a){"use strict";this.$19=a};e.exports=a}),null);
__d("PhotoStorePagedQueryCacheCore",["PagedQuery","PagedQueryCache"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i;b=babelHelpers.inherits(a,h);i=b&&b.prototype;function a(a,b){"use strict";var c=a.query_results,d=a.query_metadata,e=g.constructFromPath(d.query_string,d.query_path);i.constructor.call(this,b,e,c,babelHelpers["extends"]({enableLooping:!0},d.config));this.$PhotoStorePagedQueryCacheCore1=a.set_id;this.$PhotoStorePagedQueryCacheCore2=a.payloadsource;this.setPayloadCallback(this.$PhotoStorePagedQueryCacheCore3.bind(this))}a.prototype.$PhotoStorePagedQueryCacheCore3=function(a){"use strict";a.set_id=this.$PhotoStorePagedQueryCacheCore1,this.broadcastUpdate(this.$PhotoStorePagedQueryCacheCore2,a)};a.prototype.broadcastUpdate=function(a,b){"use strict"};e.exports=a}),null);
__d("replaceJSMarkupMarkers",["HTML"],(function(a,b,c,d,e,f,g){__p&&__p();function h(a){return a&&typeof a==="object"}function i(a){__p&&__p();if(!h(a))return a;loop:for(var b in a){if(h(a[b])&&Object.prototype.hasOwnProperty.call(a[b],"markup")){var c=a[b].markup;if(h(c)&&Object.prototype.hasOwnProperty.call(c,"__html")){a[b]=g.replaceJSONWrapper(c).getRootNode();continue loop}}a[b]=i(a[b])}return a}e.exports=i}),null);
__d("MSnowflakePagedQueryCache",["MPhotoCentralUpdates","MRequest","MSnowflakeJSConstants","PhotoStorePagedQueryCacheCore","replaceJSMarkupMarkers"],(function(a,b,c,d,e,f,g,h,i,j,k){__p&&__p();var l;function m(a,b,c,d,e,f,g,j){b=new h(i.PAGE_PATH).setData({set:a,first:g.first,after:g.after,_ft_:c});b.listen("done",function(a){a=k(a.payload);j({requested_indices:e,query_results:a.output,query_metadata:{query_string:a.query},query_params:g})});b.send()}b=babelHelpers.inherits(a,j);l=b&&b.prototype;function a(a){"use strict";l.constructor.call(this,a,m.bind(null,a.set_id,a.tracking_data))}a.prototype.broadcastUpdate=function(a,b){"use strict";g.handleUpdate(a,b)};e.exports=a}),null);